The token has not been saved to the git credentials helper. Pass `add_to_git_credential=True` in this function directly or `--add-to-git-credential` if using via `huggingface-cli` if you want to set the git credential as well.
Token is valid (permission: fineGrained).
Your token has been saved to /home/jeongseokoh/.cache/huggingface/token
Login successful
INFO 08-06 18:23:24 llm_engine.py:161] Initializing an LLM engine (v0.5.0.post1) with config: model='meta-llama/Meta-Llama-3-8B-Instruct', speculative_config=None, tokenizer='meta-llama/Meta-Llama-3-8B-Instruct', skip_tokenizer_init=False, tokenizer_mode=auto, revision=None, rope_scaling=None, rope_theta=None, tokenizer_revision=None, trust_remote_code=False, dtype=torch.bfloat16, max_seq_len=8192, download_dir='../../hub/model/', load_format=LoadFormat.AUTO, tensor_parallel_size=1, disable_custom_all_reduce=False, quantization=None, enforce_eager=False, kv_cache_dtype=auto, quantization_param_path=None, device_config=cuda, decoding_config=DecodingConfig(guided_decoding_backend='outlines'), seed=0, served_model_name=meta-llama/Meta-Llama-3-8B-Instruct)
INFO 08-06 18:23:28 weight_utils.py:218] Using model weights format ['*.safetensors']
INFO 08-06 18:23:33 model_runner.py:160] Loading model weights took 14.9595 GB
INFO 08-06 18:23:34 gpu_executor.py:83] # GPU blocks: 13407, # CPU blocks: 2048
INFO 08-06 18:23:38 model_runner.py:889] Capturing the model for CUDA graphs. This may lead to unexpected consequences if the model is not static. To run the model in eager mode, set 'enforce_eager=True' or use '--enforce-eager' in the CLI.
INFO 08-06 18:23:38 model_runner.py:893] CUDA graphs can take additional 1~3 GiB memory per GPU. If you are running out of memory, consider decreasing `gpu_memory_utilization` or enforcing eager mode. You can also reduce the `max_num_seqs` as needed to decrease memory usage.
INFO 08-06 18:23:47 model_runner.py:965] Graph capturing finished in 10 secs.
Model: llama3_8b is selected
Dataset: gsm8k is selected
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|██████████| 1/1 [00:03<00:00,  3.26s/it, est. speed input: 284.82 toks/s, output: 38.63 toks/s]Processed prompts: 100%|██████████| 1/1 [00:03<00:00,  3.26s/it, est. speed input: 284.82 toks/s, output: 38.63 toks/s]
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|██████████| 1/1 [00:02<00:00,  2.06s/it, est. speed input: 451.57 toks/s, output: 612.44 toks/s]Processed prompts: 100%|██████████| 1/1 [00:02<00:00,  2.06s/it, est. speed input: 451.57 toks/s, output: 612.44 toks/s]
Processed prompts:   0%|          | 0/10 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts:  10%|█         | 1/10 [00:03<00:30,  3.37s/it, est. speed input: 294.61 toks/s, output: 83.16 toks/s]Processed prompts:  20%|██        | 2/10 [00:03<00:12,  1.58s/it, est. speed input: 535.95 toks/s, output: 171.27 toks/s]Processed prompts:  30%|███       | 3/10 [00:03<00:06,  1.09it/s, est. speed input: 776.02 toks/s, output: 262.32 toks/s]Processed prompts:  90%|█████████ | 9/10 [00:03<00:00,  4.86it/s, est. speed input: 2246.79 toks/s, output: 820.65 toks/s]Processed prompts: 100%|██████████| 10/10 [00:04<00:00,  2.35it/s, est. speed input: 2335.49 toks/s, output: 860.27 toks/s]
Original Correct: 18, True
Golden    Answer: 18
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|██████████| 1/1 [00:01<00:00,  1.89s/it, est. speed input: 472.49 toks/s, output: 37.61 toks/s]Processed prompts: 100%|██████████| 1/1 [00:01<00:00,  1.89s/it, est. speed input: 472.49 toks/s, output: 37.61 toks/s]
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|██████████| 1/1 [00:01<00:00,  1.18s/it, est. speed input: 756.87 toks/s, output: 593.94 toks/s]Processed prompts: 100%|██████████| 1/1 [00:01<00:00,  1.18s/it, est. speed input: 756.87 toks/s, output: 593.94 toks/s]
Processed prompts:   0%|          | 0/10 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts:  10%|█         | 1/10 [00:03<00:27,  3.09s/it, est. speed input: 300.18 toks/s, output: 74.80 toks/s]Processed prompts:  60%|██████    | 6/10 [00:03<00:01,  2.43it/s, est. speed input: 1700.56 toks/s, output: 452.50 toks/s]Processed prompts:  90%|█████████ | 9/10 [00:03<00:00,  3.88it/s, est. speed input: 2432.98 toks/s, output: 671.60 toks/s]Processed prompts: 100%|██████████| 10/10 [00:03<00:00,  2.87it/s, est. speed input: 2664.54 toks/s, output: 744.46 toks/s]
Original Correct: 3, True
Golden    Answer: 3
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|██████████| 1/1 [00:04<00:00,  4.92s/it, est. speed input: 186.15 toks/s, output: 39.26 toks/s]Processed prompts: 100%|██████████| 1/1 [00:04<00:00,  4.92s/it, est. speed input: 186.15 toks/s, output: 39.26 toks/s]
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|██████████| 1/1 [00:03<00:00,  3.06s/it, est. speed input: 299.25 toks/s, output: 627.92 toks/s]Processed prompts: 100%|██████████| 1/1 [00:03<00:00,  3.06s/it, est. speed input: 299.25 toks/s, output: 627.92 toks/s]
Processed prompts:   0%|          | 0/10 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts:  10%|█         | 1/10 [00:05<00:46,  5.14s/it, est. speed input: 196.53 toks/s, output: 83.78 toks/s]Processed prompts:  20%|██        | 2/10 [00:05<00:18,  2.35s/it, est. speed input: 365.43 toks/s, output: 157.59 toks/s]Processed prompts:  30%|███       | 3/10 [00:06<00:11,  1.60s/it, est. speed input: 485.02 toks/s, output: 240.67 toks/s]Processed prompts:  40%|████      | 4/10 [00:06<00:06,  1.03s/it, est. speed input: 632.49 toks/s, output: 331.73 toks/s]Processed prompts:  60%|██████    | 6/10 [00:06<00:02,  1.83it/s, est. speed input: 913.55 toks/s, output: 517.32 toks/s]Processed prompts:  70%|███████   | 7/10 [00:06<00:01,  2.06it/s, est. speed input: 1016.23 toks/s, output: 587.88 toks/s]Processed prompts:  80%|████████  | 8/10 [00:08<00:01,  1.13it/s, est. speed input: 911.50 toks/s, output: 529.68 toks/s] Processed prompts:  90%|█████████ | 9/10 [00:09<00:00,  1.08it/s, est. speed input: 920.58 toks/s, output: 568.29 toks/s]Processed prompts: 100%|██████████| 10/10 [00:12<00:00,  1.42s/it, est. speed input: 807.39 toks/s, output: 516.13 toks/s]Processed prompts: 100%|██████████| 10/10 [00:12<00:00,  1.25s/it, est. speed input: 807.39 toks/s, output: 516.13 toks/s]
Original Correct: 40000, False
Golden    Answer: 70000
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|██████████| 1/1 [00:01<00:00,  1.95s/it, est. speed input: 461.33 toks/s, output: 37.93 toks/s]Processed prompts: 100%|██████████| 1/1 [00:01<00:00,  1.95s/it, est. speed input: 461.33 toks/s, output: 37.93 toks/s]
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|██████████| 1/1 [00:01<00:00,  1.27s/it, est. speed input: 709.17 toks/s, output: 583.07 toks/s]Processed prompts: 100%|██████████| 1/1 [00:01<00:00,  1.27s/it, est. speed input: 709.17 toks/s, output: 583.07 toks/s]
Processed prompts:   0%|          | 0/10 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts:  10%|█         | 1/10 [00:02<00:21,  2.42s/it, est. speed input: 387.09 toks/s, output: 72.29 toks/s]Processed prompts: 100%|██████████| 10/10 [00:02<00:00,  4.98it/s, est. speed input: 3502.31 toks/s, output: 696.72 toks/s]Processed prompts: 100%|██████████| 10/10 [00:02<00:00,  3.74it/s, est. speed input: 3502.31 toks/s, output: 696.72 toks/s]
Original Correct: 540, True
Golden    Answer: 540
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|██████████| 1/1 [00:05<00:00,  5.11s/it, est. speed input: 190.66 toks/s, output: 39.35 toks/s]Processed prompts: 100%|██████████| 1/1 [00:05<00:00,  5.11s/it, est. speed input: 190.66 toks/s, output: 39.35 toks/s]
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|██████████| 1/1 [00:03<00:00,  3.18s/it, est. speed input: 306.24 toks/s, output: 628.81 toks/s]Processed prompts: 100%|██████████| 1/1 [00:03<00:00,  3.18s/it, est. speed input: 306.24 toks/s, output: 628.81 toks/s]
Processed prompts:   0%|          | 0/10 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts:  10%|█         | 1/10 [00:02<00:22,  2.54s/it, est. speed input: 422.30 toks/s, output: 59.37 toks/s]Processed prompts:  20%|██        | 2/10 [00:03<00:10,  1.36s/it, est. speed input: 697.23 toks/s, output: 126.27 toks/s]Processed prompts:  30%|███       | 3/10 [00:04<00:09,  1.39s/it, est. speed input: 716.47 toks/s, output: 168.78 toks/s]Processed prompts:  40%|████      | 4/10 [00:05<00:06,  1.12s/it, est. speed input: 823.29 toks/s, output: 206.01 toks/s]Processed prompts:  50%|█████     | 5/10 [00:05<00:04,  1.16it/s, est. speed input: 957.27 toks/s, output: 281.83 toks/s]Processed prompts:  60%|██████    | 6/10 [00:05<00:02,  1.54it/s, est. speed input: 1100.67 toks/s, output: 375.09 toks/s]Processed prompts:  70%|███████   | 7/10 [00:06<00:02,  1.47it/s, est. speed input: 1139.25 toks/s, output: 405.81 toks/s]Processed prompts:  80%|████████  | 8/10 [00:07<00:01,  1.24it/s, est. speed input: 1118.54 toks/s, output: 451.22 toks/s]Processed prompts:  90%|█████████ | 9/10 [00:08<00:00,  1.07it/s, est. speed input: 1086.30 toks/s, output: 487.74 toks/s]Processed prompts: 100%|██████████| 10/10 [00:11<00:00,  1.44s/it, est. speed input: 937.37 toks/s, output: 483.78 toks/s]Processed prompts: 100%|██████████| 10/10 [00:11<00:00,  1.15s/it, est. speed input: 937.37 toks/s, output: 483.78 toks/s]
Original Correct: 20, True
Golden    Answer: 20
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|██████████| 1/1 [00:05<00:00,  5.50s/it, est. speed input: 167.31 toks/s, output: 38.92 toks/s]Processed prompts: 100%|██████████| 1/1 [00:05<00:00,  5.50s/it, est. speed input: 167.31 toks/s, output: 38.92 toks/s]
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|██████████| 1/1 [00:03<00:00,  3.43s/it, est. speed input: 268.60 toks/s, output: 624.78 toks/s]Processed prompts: 100%|██████████| 1/1 [00:03<00:00,  3.43s/it, est. speed input: 268.60 toks/s, output: 624.78 toks/s]
Processed prompts:   0%|          | 0/10 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts:  10%|█         | 1/10 [00:02<00:26,  2.97s/it, est. speed input: 345.67 toks/s, output: 55.20 toks/s]Processed prompts:  20%|██        | 2/10 [00:03<00:10,  1.33s/it, est. speed input: 652.84 toks/s, output: 120.46 toks/s]Processed prompts:  30%|███       | 3/10 [00:03<00:05,  1.25it/s, est. speed input: 928.67 toks/s, output: 171.81 toks/s]Processed prompts:  40%|████      | 4/10 [00:03<00:03,  1.83it/s, est. speed input: 1180.99 toks/s, output: 228.84 toks/s]Processed prompts:  50%|█████     | 5/10 [00:03<00:02,  2.03it/s, est. speed input: 1324.42 toks/s, output: 283.19 toks/s]Processed prompts:  60%|██████    | 6/10 [00:04<00:01,  2.68it/s, est. speed input: 1533.65 toks/s, output: 368.60 toks/s]Processed prompts:  80%|████████  | 8/10 [00:04<00:00,  4.21it/s, est. speed input: 1950.21 toks/s, output: 524.82 toks/s]Processed prompts: 100%|██████████| 10/10 [00:04<00:00,  4.92it/s, est. speed input: 2270.72 toks/s, output: 643.85 toks/s]Processed prompts: 100%|██████████| 10/10 [00:04<00:00,  2.21it/s, est. speed input: 2270.72 toks/s, output: 643.85 toks/s]
Original Correct: 64, True
Golden    Answer: 64
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|██████████| 1/1 [00:02<00:00,  2.95s/it, est. speed input: 307.94 toks/s, output: 38.70 toks/s]Processed prompts: 100%|██████████| 1/1 [00:02<00:00,  2.95s/it, est. speed input: 307.94 toks/s, output: 38.70 toks/s]
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|██████████| 1/1 [00:01<00:00,  1.86s/it, est. speed input: 486.78 toks/s, output: 611.82 toks/s]Processed prompts: 100%|██████████| 1/1 [00:01<00:00,  1.86s/it, est. speed input: 486.78 toks/s, output: 611.82 toks/s]
Processed prompts:   0%|          | 0/10 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts:  10%|█         | 1/10 [00:03<00:31,  3.47s/it, est. speed input: 277.72 toks/s, output: 94.49 toks/s]Processed prompts:  60%|██████    | 6/10 [00:03<00:01,  2.19it/s, est. speed input: 1589.68 toks/s, output: 540.89 toks/s]Processed prompts: 100%|██████████| 10/10 [00:03<00:00,  2.75it/s, est. speed input: 2649.28 toks/s, output: 913.78 toks/s]
Original Correct: 260, True
Golden    Answer: 260
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|██████████| 1/1 [00:06<00:00,  6.46s/it, est. speed input: 144.13 toks/s, output: 39.48 toks/s]Processed prompts: 100%|██████████| 1/1 [00:06<00:00,  6.46s/it, est. speed input: 144.13 toks/s, output: 39.48 toks/s]
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|██████████| 1/1 [00:04<00:00,  4.05s/it, est. speed input: 229.63 toks/s, output: 626.48 toks/s]Processed prompts: 100%|██████████| 1/1 [00:04<00:00,  4.05s/it, est. speed input: 229.63 toks/s, output: 626.48 toks/s]
Processed prompts:   0%|          | 0/10 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts:  10%|█         | 1/10 [00:04<00:44,  4.98s/it, est. speed input: 212.31 toks/s, output: 77.06 toks/s]Processed prompts:  20%|██        | 2/10 [00:06<00:21,  2.72s/it, est. speed input: 345.37 toks/s, output: 150.32 toks/s]Processed prompts:  30%|███       | 3/10 [00:06<00:11,  1.61s/it, est. speed input: 494.33 toks/s, output: 230.34 toks/s]Processed prompts:  40%|████      | 4/10 [00:06<00:07,  1.19s/it, est. speed input: 607.85 toks/s, output: 308.38 toks/s]Processed prompts:  50%|█████     | 5/10 [00:07<00:04,  1.16it/s, est. speed input: 731.09 toks/s, output: 391.11 toks/s]Processed prompts:  60%|██████    | 6/10 [00:07<00:02,  1.39it/s, est. speed input: 825.54 toks/s, output: 488.71 toks/s]Processed prompts:  70%|███████   | 7/10 [00:07<00:01,  1.78it/s, est. speed input: 934.90 toks/s, output: 576.64 toks/s]Processed prompts:  90%|█████████ | 9/10 [00:08<00:00,  2.25it/s, est. speed input: 1112.43 toks/s, output: 752.95 toks/s]Processed prompts: 100%|██████████| 10/10 [00:09<00:00,  2.01it/s, est. speed input: 1149.12 toks/s, output: 799.06 toks/s]Processed prompts: 100%|██████████| 10/10 [00:09<00:00,  1.09it/s, est. speed input: 1149.12 toks/s, output: 799.06 toks/s]
Original Correct: 120, False
Golden    Answer: 160
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|██████████| 1/1 [00:05<00:00,  5.21s/it, est. speed input: 185.46 toks/s, output: 39.32 toks/s]Processed prompts: 100%|██████████| 1/1 [00:05<00:00,  5.21s/it, est. speed input: 185.46 toks/s, output: 39.32 toks/s]
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|██████████| 1/1 [00:03<00:00,  3.24s/it, est. speed input: 298.32 toks/s, output: 629.33 toks/s]Processed prompts: 100%|██████████| 1/1 [00:03<00:00,  3.24s/it, est. speed input: 298.32 toks/s, output: 629.33 toks/s]
Processed prompts:   0%|          | 0/10 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts:  10%|█         | 1/10 [00:07<01:04,  7.19s/it, est. speed input: 148.60 toks/s, output: 107.73 toks/s]Processed prompts:  20%|██        | 2/10 [00:07<00:24,  3.11s/it, est. speed input: 287.49 toks/s, output: 211.25 toks/s]Processed prompts:  40%|████      | 4/10 [00:07<00:07,  1.27s/it, est. speed input: 548.73 toks/s, output: 410.91 toks/s]Processed prompts:  50%|█████     | 5/10 [00:08<00:04,  1.01it/s, est. speed input: 655.50 toks/s, output: 507.47 toks/s]Processed prompts:  70%|███████   | 7/10 [00:08<00:01,  1.60it/s, est. speed input: 871.39 toks/s, output: 699.39 toks/s]Processed prompts:  80%|████████  | 8/10 [00:08<00:01,  1.94it/s, est. speed input: 974.66 toks/s, output: 786.61 toks/s]Processed prompts:  90%|█████████ | 9/10 [00:08<00:00,  2.37it/s, est. speed input: 1077.22 toks/s, output: 883.97 toks/s]Processed prompts: 100%|██████████| 10/10 [00:10<00:00,  1.18it/s, est. speed input: 979.04 toks/s, output: 818.76 toks/s]Processed prompts: 100%|██████████| 10/10 [00:10<00:00,  1.09s/it, est. speed input: 979.04 toks/s, output: 818.76 toks/s]
Original Correct: 355, False
Golden    Answer: 45
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|██████████| 1/1 [00:03<00:00,  3.33s/it, est. speed input: 276.86 toks/s, output: 38.39 toks/s]Processed prompts: 100%|██████████| 1/1 [00:03<00:00,  3.33s/it, est. speed input: 276.86 toks/s, output: 38.39 toks/s]
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|██████████| 1/1 [00:02<00:00,  2.09s/it, est. speed input: 441.66 toks/s, output: 612.47 toks/s]Processed prompts: 100%|██████████| 1/1 [00:02<00:00,  2.09s/it, est. speed input: 441.66 toks/s, output: 612.47 toks/s]
Processed prompts:   0%|          | 0/10 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts:  10%|█         | 1/10 [00:01<00:13,  1.54s/it, est. speed input: 640.45 toks/s, output: 19.47 toks/s]Processed prompts:  20%|██        | 2/10 [00:03<00:12,  1.53s/it, est. speed input: 643.56 toks/s, output: 94.22 toks/s]Processed prompts:  40%|████      | 4/10 [00:03<00:04,  1.36it/s, est. speed input: 1097.63 toks/s, output: 234.37 toks/s]Processed prompts:  50%|█████     | 5/10 [00:03<00:02,  1.81it/s, est. speed input: 1322.01 toks/s, output: 310.74 toks/s]Processed prompts:  70%|███████   | 7/10 [00:03<00:00,  3.11it/s, est. speed input: 1791.47 toks/s, output: 484.88 toks/s]Processed prompts: 100%|██████████| 10/10 [00:04<00:00,  3.63it/s, est. speed input: 2171.93 toks/s, output: 686.78 toks/s]Processed prompts: 100%|██████████| 10/10 [00:04<00:00,  2.20it/s, est. speed input: 2171.93 toks/s, output: 686.78 toks/s]
Original Correct: 460, True
Golden    Answer: 460
Total Accuracy: 0.7
