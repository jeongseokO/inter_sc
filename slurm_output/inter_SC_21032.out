The token has not been saved to the git credentials helper. Pass `add_to_git_credential=True` in this function directly or `--add-to-git-credential` if using via `huggingface-cli` if you want to set the git credential as well.
Token is valid (permission: fineGrained).
Your token has been saved to /home/jeongseokoh/.cache/huggingface/token
Login successful
Inter SC_beam
Num Path: 10 + 5 x 2, Interval: 85
INFO 08-11 23:49:28 llm_engine.py:161] Initializing an LLM engine (v0.5.0.post1) with config: model='meta-llama/Meta-Llama-3-8B-Instruct', speculative_config=None, tokenizer='meta-llama/Meta-Llama-3-8B-Instruct', skip_tokenizer_init=False, tokenizer_mode=auto, revision=None, rope_scaling=None, rope_theta=None, tokenizer_revision=None, trust_remote_code=False, dtype=torch.bfloat16, max_seq_len=8192, download_dir='../../hub/model/', load_format=LoadFormat.AUTO, tensor_parallel_size=1, disable_custom_all_reduce=False, quantization=None, enforce_eager=False, kv_cache_dtype=auto, quantization_param_path=None, device_config=cuda, decoding_config=DecodingConfig(guided_decoding_backend='outlines'), seed=0, served_model_name=meta-llama/Meta-Llama-3-8B-Instruct)
INFO 08-11 23:49:32 weight_utils.py:218] Using model weights format ['*.safetensors']
INFO 08-11 23:49:36 model_runner.py:160] Loading model weights took 14.9595 GB
INFO 08-11 23:49:37 gpu_executor.py:83] # GPU blocks: 13407, # CPU blocks: 2048
INFO 08-11 23:49:41 model_runner.py:889] Capturing the model for CUDA graphs. This may lead to unexpected consequences if the model is not static. To run the model in eager mode, set 'enforce_eager=True' or use '--enforce-eager' in the CLI.
INFO 08-11 23:49:41 model_runner.py:893] CUDA graphs can take additional 1~3 GiB memory per GPU. If you are running out of memory, consider decreasing `gpu_memory_utilization` or enforcing eager mode. You can also reduce the `max_num_seqs` as needed to decrease memory usage.
INFO 08-11 23:49:51 model_runner.py:965] Graph capturing finished in 10 secs.
Model: llama3_8b is selected
Dataset: mmlu is selected
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|██████████| 1/1 [00:08<00:00,  8.76s/it, est. speed input: 185.72 toks/s, output: 157.16 toks/s]Processed prompts: 100%|██████████| 1/1 [00:08<00:00,  8.76s/it, est. speed input: 185.72 toks/s, output: 157.16 toks/s]
/data2/jeongseokoh/miniconda3/envs/myenv/lib/python3.9/site-packages/sklearn/metrics/pairwise.py:2361: DataConversionWarning: Data was converted to boolean for metric jaccard
  warnings.warn(msg, DataConversionWarning)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
Generation job: 8.769801518996246 sec
Added Probs: [-0.09174316690156334, -0.127005872130394, -0.11231717888427817, -0.13885506857996402, -0.2960409079404438, -0.12331041419407823, -0.12013539501387088, -0.12000827174237434, -0.13262899005312032, -0.12405482524970793]
Cluster Indices: {0: [5, 6], 1: [4], 2: [0, 1, 2], 3: [7, 8, 9], 4: [3]}
Selected Indexes: [6, 4, 0, 7, 3]
Processed prompts:   0%|          | 0/5 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts:  20%|██        | 1/5 [00:00<00:03,  1.09it/s, est. speed input: 1994.08 toks/s, output: 2.18 toks/s]Processed prompts:  60%|██████    | 3/5 [00:02<00:01,  1.43it/s, est. speed input: 2469.17 toks/s, output: 32.78 toks/s]Processed prompts: 100%|██████████| 5/5 [00:03<00:00,  1.25it/s, est. speed input: 2198.35 toks/s, output: 76.20 toks/s]Processed prompts: 100%|██████████| 5/5 [00:03<00:00,  1.27it/s, est. speed input: 2198.35 toks/s, output: 76.20 toks/s]
/data2/jeongseokoh/miniconda3/envs/myenv/lib/python3.9/site-packages/sklearn/metrics/pairwise.py:2361: DataConversionWarning: Data was converted to boolean for metric jaccard
  warnings.warn(msg, DataConversionWarning)
Generation job: 3.9892862789565697 sec
Added Probs: [-0.12013539501387088, -0.12013539501387088, -0.2145841152422012, -0.3478797444452842, -0.11048948481867585, -0.12586978135944962, -0.12000827174237434, -0.12000827174237434, -0.1508517330405356, -0.21947200202172804]
Cluster Indices: {0: [4, 5], 1: [6, 7], 2: [2, 3], 3: [0, 1], 4: [8, 9]}
Selected Indexes: [4, 6, 2, 0, 8]
step: 2
Processed prompts:   0%|          | 0/5 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts:  20%|██        | 1/5 [00:00<00:03,  1.08it/s, est. speed input: 2002.86 toks/s, output: 2.15 toks/s]Processed prompts:  60%|██████    | 3/5 [00:02<00:01,  1.51it/s, est. speed input: 2595.80 toks/s, output: 33.31 toks/s]Processed prompts:  80%|████████  | 4/5 [00:02<00:00,  1.97it/s, est. speed input: 3096.49 toks/s, output: 65.58 toks/s]Processed prompts: 100%|██████████| 5/5 [00:02<00:00,  2.19it/s, est. speed input: 3844.77 toks/s, output: 102.31 toks/s]
/data2/jeongseokoh/miniconda3/envs/myenv/lib/python3.9/site-packages/sklearn/metrics/pairwise.py:2361: DataConversionWarning: Data was converted to boolean for metric jaccard
  warnings.warn(msg, DataConversionWarning)
Generation job: 2.3031958770006895 sec
Added Probs: [-0.12812235939108635, -0.14283104177753805, -0.12000827174237434, -0.12000827174237434, -0.24104760064089553, -0.2589644066144511, -0.12013539501387088, -0.12013539501387088, -0.16040677178737728, -0.162683775027593]
Cluster Indices: {0: [4, 5], 1: [6, 7], 2: [2, 3], 3: [8, 9], 4: [0, 1]}
Selected Indexes: [4, 6, 2, 8, 0]
step: 2
Processed prompts:   0%|          | 0/5 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts:  20%|██        | 1/5 [00:00<00:03,  1.08it/s, est. speed input: 1969.26 toks/s, output: 2.16 toks/s]Processed prompts:  60%|██████    | 3/5 [00:02<00:01,  1.43it/s, est. speed input: 2496.97 toks/s, output: 36.01 toks/s]Processed prompts: 100%|██████████| 5/5 [00:02<00:00,  2.55it/s, est. speed input: 3761.21 toks/s, output: 97.52 toks/s]Processed prompts: 100%|██████████| 5/5 [00:02<00:00,  2.11it/s, est. speed input: 3761.21 toks/s, output: 97.52 toks/s]
/data2/jeongseokoh/miniconda3/envs/myenv/lib/python3.9/site-packages/sklearn/metrics/pairwise.py:2361: DataConversionWarning: Data was converted to boolean for metric jaccard
  warnings.warn(msg, DataConversionWarning)
Generation job: 2.383826181991026 sec
Added Probs: [-0.20431590114386028, -0.21540974717558795, -0.12013539501387088, -0.12013539501387088, -0.12000827174237434, -0.12000827174237434, -0.1612438715394886, -0.18014874165842992, -0.1530308999781367, -0.18546962412074208]
Cluster Indices: {0: [4, 5], 1: [6, 7], 2: [0, 1], 3: [2, 3], 4: [8, 9]}
Selected Indexes: [4, 6, 0, 2, 8]
step: 2
Processed prompts:   0%|          | 0/5 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts:  20%|██        | 1/5 [00:00<00:03,  1.06it/s, est. speed input: 1974.43 toks/s, output: 2.12 toks/s]Processed prompts:  60%|██████    | 3/5 [00:01<00:00,  2.13it/s, est. speed input: 3525.40 toks/s, output: 20.62 toks/s]Processed prompts:  80%|████████  | 4/5 [00:02<00:00,  1.55it/s, est. speed input: 2859.46 toks/s, output: 48.26 toks/s]Processed prompts: 100%|██████████| 5/5 [00:04<00:00,  1.02it/s, est. speed input: 2155.89 toks/s, output: 66.86 toks/s]Processed prompts: 100%|██████████| 5/5 [00:04<00:00,  1.19it/s, est. speed input: 2155.89 toks/s, output: 66.86 toks/s]
/data2/jeongseokoh/miniconda3/envs/myenv/lib/python3.9/site-packages/sklearn/metrics/pairwise.py:2361: DataConversionWarning: Data was converted to boolean for metric jaccard
  warnings.warn(msg, DataConversionWarning)
Generation job: 4.206611645990051 sec
Added Probs: [-0.12000827174237434, -0.12000827174237434, -0.2141678216004813, -0.19982464930106852, -0.17241460668761827, -0.19993814192094855, -0.12013539501387088, -0.12013539501387088, -0.14507339660857999, -0.14507339660857999]
Cluster Indices: {0: [4, 5], 1: [6, 7], 2: [8, 9], 3: [0, 1], 4: [2, 3]}
Selected Indexes: [4, 6, 8, 0, 3]
step: 2
Processed prompts:   0%|          | 0/5 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts:  20%|██        | 1/5 [00:00<00:03,  1.06it/s, est. speed input: 1897.63 toks/s, output: 2.11 toks/s]Processed prompts: 100%|██████████| 5/5 [00:02<00:00,  2.11it/s, est. speed input: 3668.25 toks/s, output: 43.07 toks/s]Processed prompts: 100%|██████████| 5/5 [00:02<00:00,  1.99it/s, est. speed input: 3668.25 toks/s, output: 43.07 toks/s]
/data2/jeongseokoh/miniconda3/envs/myenv/lib/python3.9/site-packages/sklearn/metrics/pairwise.py:2361: DataConversionWarning: Data was converted to boolean for metric jaccard
  warnings.warn(msg, DataConversionWarning)
Generation job: 2.5247817130293697 sec
Added Probs: [-0.17241460668761827, -0.17241460668761827, -0.12013539501387088, -0.12013539501387088, -0.14507339660857999, -0.14507339660857999, -0.12000827174237434, -0.12000827174237434, -0.23269189678813856, -0.28351514447819104]
Cluster Indices: {0: [4, 5], 1: [6, 7], 2: [2, 3], 3: [0, 1], 4: [8, 9]}
Selected Indexes: [4, 6, 2, 0, 8]
step: 2
Processed prompts:   0%|          | 0/5 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts:  20%|██        | 1/5 [00:00<00:03,  1.05it/s, est. speed input: 1885.61 toks/s, output: 2.10 toks/s]Processed prompts: 100%|██████████| 5/5 [00:02<00:00,  2.07it/s, est. speed input: 3615.42 toks/s, output: 41.83 toks/s]Processed prompts: 100%|██████████| 5/5 [00:02<00:00,  1.95it/s, est. speed input: 3615.42 toks/s, output: 41.83 toks/s]
/data2/jeongseokoh/miniconda3/envs/myenv/lib/python3.9/site-packages/sklearn/metrics/pairwise.py:2361: DataConversionWarning: Data was converted to boolean for metric jaccard
  warnings.warn(msg, DataConversionWarning)
Generation job: 2.5765040160622448 sec
Added Probs: [-0.14507339660857999, -0.14507339660857999, -0.12000827174237434, -0.12000827174237434, -0.12013539501387088, -0.12013539501387088, -0.17241460668761827, -0.17241460668761827, -0.22137659514042998, -0.2283968640029278]
Cluster Indices: {0: [4, 5], 1: [8, 9], 2: [2, 3], 3: [6, 7], 4: [0, 1]}
Selected Indexes: [4, 8, 2, 6, 0]
step: 2
Processed prompts:   0%|          | 0/5 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts:  20%|██        | 1/5 [00:00<00:03,  1.01it/s, est. speed input: 1843.12 toks/s, output: 2.02 toks/s]Processed prompts:  80%|████████  | 4/5 [00:01<00:00,  3.86it/s, est. speed input: 5803.00 toks/s, output: 6.37 toks/s]Processed prompts: 100%|██████████| 5/5 [00:01<00:00,  3.75it/s, est. speed input: 6964.11 toks/s, output: 11.99 toks/s]
/data2/jeongseokoh/miniconda3/envs/myenv/lib/python3.9/site-packages/sklearn/metrics/pairwise.py:2361: DataConversionWarning: Data was converted to boolean for metric jaccard
  warnings.warn(msg, DataConversionWarning)
Generation job: 1.352810968994163 sec
Added Probs: [-0.12013539501387088, -0.12013539501387088, -0.2304465019167998, -0.2304465019167998, -0.12000827174237434, -0.12000827174237434, -0.17241460668761827, -0.17241460668761827, -0.14507339660857999, -0.14507339660857999]
Cluster Indices: {0: [4, 5], 1: [6, 7], 2: [2, 3], 3: [0, 1], 4: [8, 9]}
Selected Indexes: [4, 6, 2, 0, 8]
step: 2
Found EoS token, Break
completions: ['<|start_header_id|>assistant<|end_header_id|>\n\nStep 1: The energy difference between the states is given by the energy difference between the states, which is given by the Rydberg formula:\n\nΔE = R(1/n2 - 1/m2)\n\nwhere R is the Rydberg constant, n is the initial state (n=3), and m is the final state (n=1).\n\nStep 2: Plug in the values:\n\nΔE = R(1/3^2 - 1/1^2) = R(1/9 - 1) = R × 8/9\n\nStep 3: The Rydberg constant is approximately 13.6 eV.\n\nStep 4: Plug in the value of R:\n\nΔE = 13.6 eV × 8/9 = 12.2 eV\n\nStep 5: The energy of the photon emitted is closest to 12.2 eV, which is option #### C.******', '<|start_header_id|>assistant<|end_header_id|>\n\nStep 1: The energy difference between the states is given by the energy difference between the states, which is given by the Rydberg formula:\n\nΔE = R(1/n2 - 1/m2)\n\nwhere R is the Rydberg constant, n is the initial state (n=3), and m is the final state (n=1).\n\nStep 2: Plug in the values:\n\nΔE = R(1/3^2 - 1/1^2) = R(1/9 - 1) = R × 8/9\n\nStep 3: The Rydberg constant is approximately 13.6 eV.\n\nStep 4: Plug in the value of R:\n\nΔE = 13.6 eV × 8/9 = 12.2 eV\n\nStep 5: The energy of the photon emitted is closest to 12.2 eV, which is option #### C.******', '<|start_header_id|>assistant<|end_header_id|>\n\nStep 1: Positronium is an atom formed by an electron and a positron (antielectron). It is similar to the hydrogen atom, with the positron replacing the proton. ******\n\nStep 2: The energy of the photon emitted in the transition from the state with n=3 to a state with n=1 is given by the energy difference between the two states. ******\r\n\r\nStep 3: The energy of the state with n=3 is -13.6 eV, and the energy of the state with n=1 is -12.2 eV. ******\r\n\r\nStep 4: The energy of the photon emitted in this transition is the difference between the two energies: 13.6 eV - 12.2 eV = 1.4 eV. ******\r\n\r\nStep 5: However, this is not an option. The closest option is 1.3 eV, which is not available. The next closest option is 6.8 eV, which is also not available. The next closest option is 12.2 eV, which is the same as the energy of the state with n=1, so it cannot be the correct answer. The next closest option is 13.6 eV, which is the energy of the state with n=3, so it cannot be the correct answer. ******\r\n\r\nStep 6: The correct answer is not among the given options. However, the closest option is B: 6.8 eV. Since this is not the correct answer, we can try to find the correct answer. ******\r\n\r\nStep 7: The energy of the photon emitted in the transition from the state with n=3 to a state with n=1 is approximately 10.4 eV. This is not among the given options. ******\r\n\r\n#### D******', '<|start_header_id|>assistant<|end_header_id|>\n\nStep 1: Positronium is an atom formed by an electron and a positron (antielectron). It is similar to the hydrogen atom, with the positron replacing the proton. ******\n\nStep 2: The energy of the photon emitted in the transition from the state with n=3 to a state with n=1 is given by the energy difference between the two states. ******\r\n\r\nStep 3: The energy of the state with n=3 is -13.6 eV, and the energy of the state with n=1 is -12.2 eV. ******\r\n\r\nStep 4: The energy of the photon emitted in this transition is the difference between the two energies: 13.6 eV - 12.2 eV = 1.4 eV. ******\r\n\r\nStep 5: However, this is not an option. The closest option is 1.3 eV, which is not available. The next closest option is 6.8 eV, which is also not available. The next closest option is 12.2 eV, which is the same as the energy of the state with n=1, so it cannot be the correct answer. The next closest option is 13.6 eV, which is the energy of the state with n=3, so it cannot be the correct answer. ******\r\n\r\nStep 6: The correct answer is not among the given options. However, the closest option is B: 6.8 eV. Since this is not the correct answer, we can try to find the correct answer. ******\r\n\r\nStep 7: The energy of the photon emitted in the transition from the state with n=3 to a state with n=1 is approximately 10.4 eV. This is not among the given options. ******\r\n\r\n#### D******', '<|start_header_id|>assistant<|end_header_id|>\n\nStep 1: The energy difference between the two states is given by the difference in the energy of the states.\n\nStep 2: The energy of a state with principal quantum number n is given by En = -13.6 eV / n^2.\n\nStep 3: The energy of the state with n=3 is En=3 = -13.6 eV / 3^2 = -3.49 eV.\n\nStep 4: The energy of the state with n=1 is En=1 = -13.6 eV / 1^2 = -13.6 eV.\n\nStep 5: The energy difference between the two states is ΔE = En=1 - En=3 = -13.6 eV - (-3.49 eV) = 10.11 eV.\n\nStep 6: Since the problem asks for the energy of the photon emitted, we need to take the absolute value of the energy difference: ΔE = 10.11 eV.\n\nStep 7: The closest option to the calculated energy is option #### C:12.2 eV.******', '<|start_header_id|>assistant<|end_header_id|>\n\nStep 1: The energy difference between the two states is given by the difference in the energy of the states.\n\nStep 2: The energy of a state with principal quantum number n is given by En = -13.6 eV / n^2.\n\nStep 3: The energy of the state with n=3 is En=3 = -13.6 eV / 3^2 = -3.49 eV.\n\nStep 4: The energy of the state with n=1 is En=1 = -13.6 eV / 1^2 = -13.6 eV.\n\nStep 5: The energy difference between the two states is ΔE = En=1 - En=3 = -13.6 eV - (-3.49 eV) = 10.11 eV.\n\nStep 6: Since the problem asks for the energy of the photon emitted, we need to take the absolute value of the energy difference: ΔE = 10.11 eV.\n\nStep 7: The closest option to the calculated energy is option #### C:12.2 eV.******', '<|start_header_id|>assistant<|end_header_id|>\n\nStep 1: Since the positronium atom is similar to a hydrogen atom, we can use the same energy level diagram for hydrogen. ****** Step 2: The energy difference between the n=3 and n=1 states in hydrogen is 10.2 eV. ****** Step 3: Since the positron has a slightly different mass than the proton, the energy levels in positronium will be slightly shifted. ****** Step 4: However, the energy difference between the n=3 and n=1 states in positronium will be very close to 10.2 eV. ****** Step 5: Therefore, the energy of the photon emitted in this transition is closest to 10.2 eV, which is closest to option #### D:13.6 eV.******', '<|start_header_id|>assistant<|end_header_id|>\n\nStep 1: Since the positronium atom is similar to a hydrogen atom, we can use the same energy level diagram for hydrogen. ****** Step 2: The energy difference between the n=3 and n=1 states in hydrogen is 10.2 eV. ****** Step 3: Since the positron has a slightly different mass than the proton, the energy levels in positronium will be slightly shifted. ****** Step 4: However, the energy difference between the n=3 and n=1 states in positronium will be very close to 10.2 eV. ****** Step 5: Therefore, the energy of the photon emitted in this transition is closest to 10.2 eV, which is closest to option #### D:13.6 eV.******', '<|start_header_id|>assistant<|end_header_id|>\n\nStep 1: The energy of the photon emitted in the transition from n=3 to n=1 is given by the energy difference between the two states. ****** Step 2: The energy of the state with n=3 is -13.6 eV, and the energy of the state with n=1 is -13.6 eV. ****** Step 3: The energy difference between the two states is the energy of the photon emitted, which is 13.6 eV - 13.6 eV = 0 eV. ****** Step 4: However, this is not an option. The closest option is 13.6 eV, which is the energy of the state with n=1. ****** Step 5: Therefore, the correct answer is #### D.******', '<|start_header_id|>assistant<|end_header_id|>\n\nStep 1: The energy of the photon emitted in the transition from n=3 to n=1 is given by the energy difference between the two states. ****** Step 2: The energy of the state with n=3 is -13.6 eV, and the energy of the state with n=1 is -13.6 eV. ****** Step 3: The energy difference between the two states is the energy of the photon emitted, which is 13.6 eV - 13.6 eV = 0 eV. ****** Step 4: However, this is not an option. The closest option is 13.6 eV, which is the energy of the state with n=1. ****** Step 5: Therefore, the correct answer is #### D.******']
Answer Probs: []
>> Processing time: 28.770535527030006
[rank0]: Traceback (most recent call last):
[rank0]:   File "/data2/jeongseokoh/jeongseokoh/inter_SC/inter_SC_llm.py", line 918, in <module>
[rank0]:     main()
[rank0]:   File "/data2/jeongseokoh/jeongseokoh/inter_SC/inter_SC_llm.py", line 903, in main
[rank0]:     results = parallel_process(context=c_dataset, question=q_dataset, answer=a_dataset, option=o_dataset, cot_ex=cot_ex, model=model, model_name=selected_model, dataset=selected_dataset)
[rank0]:   File "/data2/jeongseokoh/jeongseokoh/inter_SC/inter_SC_llm.py", line 525, in parallel_process
[rank0]:     softsc_answer, softsc_conf = prob_process(original_answer_completion, ansProb)
[rank0]: TypeError: prob_process() missing 1 required positional argument: 'dataset'
srun: error: n02: task 0: Exited with exit code 1
