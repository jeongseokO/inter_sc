The token has not been saved to the git credentials helper. Pass `add_to_git_credential=True` in this function directly or `--add-to-git-credential` if using via `huggingface-cli` if you want to set the git credential as well.
Token is valid (permission: fineGrained).
Your token has been saved to /home/jeongseokoh/.cache/huggingface/token
Login successful
Inter SC_beam
Num Path: 10 + 5 x 2, Interval: 5
INFO 08-11 02:17:54 llm_engine.py:161] Initializing an LLM engine (v0.5.0.post1) with config: model='meta-llama/Meta-Llama-3-8B-Instruct', speculative_config=None, tokenizer='meta-llama/Meta-Llama-3-8B-Instruct', skip_tokenizer_init=False, tokenizer_mode=auto, revision=None, rope_scaling=None, rope_theta=None, tokenizer_revision=None, trust_remote_code=False, dtype=torch.bfloat16, max_seq_len=8192, download_dir='../../hub/model/', load_format=LoadFormat.AUTO, tensor_parallel_size=1, disable_custom_all_reduce=False, quantization=None, enforce_eager=False, kv_cache_dtype=auto, quantization_param_path=None, device_config=cuda, decoding_config=DecodingConfig(guided_decoding_backend='outlines'), seed=0, served_model_name=meta-llama/Meta-Llama-3-8B-Instruct)
INFO 08-11 02:17:58 weight_utils.py:218] Using model weights format ['*.safetensors']
INFO 08-11 02:18:03 model_runner.py:160] Loading model weights took 14.9595 GB
INFO 08-11 02:18:04 gpu_executor.py:83] # GPU blocks: 13407, # CPU blocks: 2048
INFO 08-11 02:18:07 model_runner.py:889] Capturing the model for CUDA graphs. This may lead to unexpected consequences if the model is not static. To run the model in eager mode, set 'enforce_eager=True' or use '--enforce-eager' in the CLI.
INFO 08-11 02:18:07 model_runner.py:893] CUDA graphs can take additional 1~3 GiB memory per GPU. If you are running out of memory, consider decreasing `gpu_memory_utilization` or enforcing eager mode. You can also reduce the `max_num_seqs` as needed to decrease memory usage.
INFO 08-11 02:18:16 model_runner.py:965] Graph capturing finished in 9 secs.
Model: llama3_8b is selected
Dataset: gsm8k is selected
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|██████████| 1/1 [00:00<00:00,  1.34it/s, est. speed input: 1561.65 toks/s, output: 268.78 toks/s]Processed prompts: 100%|██████████| 1/1 [00:00<00:00,  1.34it/s, est. speed input: 1561.65 toks/s, output: 268.78 toks/s]
/data2/jeongseokoh/miniconda3/envs/myenv/lib/python3.9/site-packages/sklearn/metrics/pairwise.py:2361: DataConversionWarning: Data was converted to boolean for metric jaccard
  warnings.warn(msg, DataConversionWarning)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
/data2/jeongseokoh/miniconda3/envs/myenv/lib/python3.9/site-packages/sklearn/base.py:1473: ConvergenceWarning: Number of distinct clusters (1) found smaller than n_clusters (5). Possibly due to duplicate points in X.
  return fit_method(estimator, *args, **kwargs)
Generation job: 0.7561823410214856 sec
Added Probs: [(20.0, 20), (20.0, 20), (20.0, 20), (20.0, 20), (20.0, 20), (20.0, 20), (20.0, 20), (20.0, 20), (20.0, 20), (20.0, 20)]
Cluster Indices: {0: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9], 1: [], 2: [], 3: [], 4: []}
Selected Indexes: [0, 1, 2, 3, 4]
Processed prompts:   0%|          | 0/5 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts:  20%|██        | 1/5 [00:01<00:06,  1.60s/it, est. speed input: 740.26 toks/s, output: 36.95 toks/s]Processed prompts: 100%|██████████| 5/5 [00:01<00:00,  3.13it/s, est. speed input: 3700.65 toks/s, output: 184.72 toks/s]
/data2/jeongseokoh/miniconda3/envs/myenv/lib/python3.9/site-packages/sklearn/metrics/pairwise.py:2361: DataConversionWarning: Data was converted to boolean for metric jaccard
  warnings.warn(msg, DataConversionWarning)
/data2/jeongseokoh/miniconda3/envs/myenv/lib/python3.9/site-packages/sklearn/base.py:1473: ConvergenceWarning: Number of distinct clusters (2) found smaller than n_clusters (5). Possibly due to duplicate points in X.
  return fit_method(estimator, *args, **kwargs)
Generation job: 1.628751339041628 sec
Added Probs: [(27.998853686163528, 29), (28.21223483962912, 30), (27.998853686163528, 29), (28.21223483962912, 30), (27.998853686163528, 29), (28.21223483962912, 30), (27.998853686163528, 29), (28.21223483962912, 30), (27.998853686163528, 29), (28.21223483962912, 30)]
Cluster Indices: {0: [1, 3, 5, 7, 9], 1: [0, 2, 4, 6, 8], 2: [], 3: [], 4: []}
Selected Indexes: [1, 0, 3, 5, 7]
Processed prompts:   0%|          | 0/5 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts:  20%|██        | 1/5 [00:01<00:06,  1.71s/it, est. speed input: 709.72 toks/s, output: 38.09 toks/s]Processed prompts: 100%|██████████| 5/5 [00:01<00:00,  2.93it/s, est. speed input: 3547.47 toks/s, output: 189.85 toks/s]
/data2/jeongseokoh/miniconda3/envs/myenv/lib/python3.9/site-packages/sklearn/metrics/pairwise.py:2361: DataConversionWarning: Data was converted to boolean for metric jaccard
  warnings.warn(msg, DataConversionWarning)
/data2/jeongseokoh/miniconda3/envs/myenv/lib/python3.9/site-packages/sklearn/base.py:1473: ConvergenceWarning: Number of distinct clusters (4) found smaller than n_clusters (5). Possibly due to duplicate points in X.
  return fit_method(estimator, *args, **kwargs)
Generation job: 1.7181329500162974 sec
Added Probs: [(31.154840557633804, 32), (30.84515947495065, 33), (30.154840557633804, 31), (30.660523645273056, 33), (31.154840557633804, 32), (30.84515947495065, 33), (31.154840557633804, 32), (30.84515947495065, 33), (31.154840557633804, 32), (30.84515947495065, 33)]
Cluster Indices: {0: [1, 5, 7, 9], 1: [0, 4, 6, 8], 2: [2], 3: [3], 4: []}
Selected Indexes: [1, 0, 2, 3, 5]
Processed prompts:   0%|          | 0/5 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts:  20%|██        | 1/5 [00:01<00:05,  1.49s/it, est. speed input: 835.52 toks/s, output: 33.61 toks/s]Processed prompts: 100%|██████████| 5/5 [00:01<00:00,  3.36it/s, est. speed input: 4173.46 toks/s, output: 168.01 toks/s]
/data2/jeongseokoh/miniconda3/envs/myenv/lib/python3.9/site-packages/sklearn/metrics/pairwise.py:2361: DataConversionWarning: Data was converted to boolean for metric jaccard
  warnings.warn(msg, DataConversionWarning)
Generation job: 1.4991407920606434 sec
Added Probs: [(24.24313123362956, 25), (23.740001980270883, 25), (24.083079777542384, 25), (24.083079777542384, 25), (24.078937916007675, 25), (24.078937916007675, 25), (23.69297266869554, 25), (23.64979961463157, 25), (24.24313123362956, 25), (23.740001980270883, 25)]
Cluster Indices: {0: [4, 5], 1: [0, 8], 2: [2, 3], 3: [6, 7], 4: [1, 9]}
Selected Indexes: [4, 0, 2, 6, 1]
Processed prompts:   0%|          | 0/5 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts:  20%|██        | 1/5 [00:01<00:06,  1.51s/it, est. speed input: 838.94 toks/s, output: 33.19 toks/s]Processed prompts: 100%|██████████| 5/5 [00:01<00:00,  3.24it/s, est. speed input: 3324.98 toks/s, output: 139.68 toks/s]Processed prompts: 100%|██████████| 5/5 [00:01<00:00,  2.63it/s, est. speed input: 3324.98 toks/s, output: 139.68 toks/s]
/data2/jeongseokoh/miniconda3/envs/myenv/lib/python3.9/site-packages/sklearn/metrics/pairwise.py:2361: DataConversionWarning: Data was converted to boolean for metric jaccard
  warnings.warn(msg, DataConversionWarning)
Generation job: 1.9158284040167928 sec
Added Probs: [(24.062176501616328, 25), (24.062176501616328, 25), (23.6805271514371, 25), (23.435608489555747, 25), (23.75832415007896, 25), (38.711284581022824, 41), (23.57674693517455, 25), (23.395674566412488, 25), (23.783669823922352, 25), (23.685322715707056, 25)]
Cluster Indices: {0: [5], 1: [7], 2: [0, 1, 4], 3: [3, 9], 4: [2, 6, 8]}
Selected Indexes: [5, 7, 0, 9, 8]
Processed prompts:   0%|          | 0/5 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts:  20%|██        | 1/5 [00:01<00:04,  1.09s/it, est. speed input: 1195.07 toks/s, output: 17.39 toks/s]Processed prompts:  60%|██████    | 3/5 [00:01<00:00,  3.09it/s, est. speed input: 3235.64 toks/s, output: 51.62 toks/s]Processed prompts: 100%|██████████| 5/5 [00:01<00:00,  4.16it/s, est. speed input: 5387.94 toks/s, output: 98.23 toks/s]
/data2/jeongseokoh/miniconda3/envs/myenv/lib/python3.9/site-packages/sklearn/metrics/pairwise.py:2361: DataConversionWarning: Data was converted to boolean for metric jaccard
  warnings.warn(msg, DataConversionWarning)
Generation job: 1.2128036490175873 sec
Added Probs: [(9.29323503745065, 10), (7.831117907844656, 9), (13.731058534881994, 14), (8.891400735150299, 10), (9.731058534881994, 10), (8.268941405276001, 9), (14.0, 14), (14.0, 14), (14.0, 14), (14.0, 14)]
Cluster Indices: {0: [4, 5], 1: [0, 1], 2: [6, 7], 3: [2, 3], 4: [8, 9]}
Selected Indexes: [4, 0, 6, 2, 8]
Found EoS token, Break
completions: ["<|start_header_id|>assistant<|end_header_id|>\n\nStep 1: Janet's ducks lay 16 eggs per day. ******\n\nStep 2: She eats 3 eggs for breakfast, so she is left with 16 - 3 = 13 eggs. ******\n\nStep 3: She bakes 4 eggs for muffins, so she is left with 13 - 4 = 9 eggs. ******\n\nStep 4: She sells the remaining 9 eggs at the farmers' market for $2 per egg. ******\n\nStep 5: To find out how much she makes, multiply the number of eggs sold (9) by the price per egg ($2): 9 x $2 = $18. ******\n\nThe answer is #### 18. ******", "<|start_header_id|>assistant<|end_header_id|>\n\nStep 1: Janet's ducks lay 16 eggs per day. ******\n\nStep 2: She eats 3 eggs for breakfast, so she is left with 16 - 3 = 13 eggs. ******\n\nStep 3: She bakes 4 eggs for muffins, so she is left with 13 - 4 = 9 eggs. ******\n\nStep 4: She sells the remaining 9 eggs at the farmers' market for $2 per egg. ******\n\nStep 5: To find out how much she makes, multiply the number of eggs sold (9) by the price per egg ($2): 9 x $2 = $18. ******\n\nThe answer is #### 18.******", "<|start_header_id|>assistant<|end_header_id|>\n\nStep 1: Janet's ducks lay 16 eggs per day. ******\n\nStep 2: She eats 3 eggs for breakfast, so she has 16 - 3 = 13 eggs left. ******\n\nStep 3: She bakes muffins for her friends using 4 eggs, leaving her with 13 - 4 = 9 eggs. *******\n\nStep 4: She sells the remaining 9 eggs at the farmers' market for $2 per egg. *******\n\nStep 5: The total amount she makes is 9 eggs * $2 per egg = $18. *******\n\nStep 6: The answer is #### 18. ******", "<|start_header_id|>assistant<|end_header_id|>\n\nStep 1: Janet's ducks lay 16 eggs per day. ******\n\nStep 2: She eats 3 eggs for breakfast, so she has 16 - 3 = 13 eggs left. ******\n\nStep 3: She bakes muffins for her friends using 4 eggs, leaving her with 13 - 4 = 9 eggs. *******\n\nStep 4: She sells the remaining 9 eggs at the farmers' market for $2 per egg. *******\n\nStep 5: The total amount she makes is 9 eggs * $2 per egg = $18. *******\n\nThe answer is #### 18. ******", "<|start_header_id|>assistant<|end_header_id|>\n\nStep 1: Janet's ducks lay 16 eggs per day. ******\n\nStep 2: She eats 3 eggs for breakfast, so she has 16 - 3 = 13 eggs left. ******\n\nStep 3: She bakes 4 eggs for muffins, so she has 13 - 4 = 9 eggs left. ******\n\nStep 4: She sells the remaining 9 eggs at the farmers' market for $2 per egg. ******\n\nStep 5: The total amount she makes is 9 eggs x $2 per egg = $18. ******\n\nThe answer is #### 18. ******", "<|start_header_id|>assistant<|end_header_id|>\n\nStep 1: Janet's ducks lay 16 eggs per day. ******\n\nStep 2: She eats 3 eggs for breakfast, so she has 16 - 3 = 13 eggs left. ******\n\nStep 3: She bakes 4 eggs for muffins, so she has 13 - 4 = 9 eggs left. ******\n\nStep 4: She sells the remaining 9 eggs at the farmers' market for $2 per egg. ******\n\nStep 5: The total amount she makes is 9 eggs x $2 per egg = $18. ******\n\nThe answer is #### 18.******", "<|start_header_id|>assistant<|end_header_id|>\n\nStep 1: Janet's ducks lay 16 eggs per day. ******\n\nStep 2: She eats 3 eggs for breakfast, so she is left with 16 - 3 = 13 eggs. ******\n\nStep 3: She bakes muffins for her friends using 4 eggs, leaving her with 13 - 4 = 9 eggs. ******\r\n\r\nStep 4: She sells the remaining 9 eggs at the farmers' market for $2 per egg. ******\r\n\r\nStep 5: The total amount she makes is 9 eggs * $2 per egg = $18. ******\r\n\r\nStep 6: The answer is #### 18. ******", "<|start_header_id|>assistant<|end_header_id|>\n\nStep 1: Janet's ducks lay 16 eggs per day. ******\n\nStep 2: She eats 3 eggs for breakfast, so she is left with 16 - 3 = 13 eggs. ******\n\nStep 3: She bakes muffins for her friends using 4 eggs, leaving her with 13 - 4 = 9 eggs. ******\r\n\r\nStep 4: She sells the remaining 9 eggs at the farmers' market for $2 per egg. ******\r\n\r\nStep 5: The total amount she makes is 9 eggs * $2 per egg = $18. ******\r\n\r\nStep 6: The answer is #### 18. ******", "<|start_header_id|>assistant<|end_header_id|>\n\nStep 1: Janet's ducks lay 16 eggs per day. ******\n\nStep 2: She eats 3 eggs for breakfast, so she is left with 16 - 3 = 13 eggs. ******\n\nStep 3: She bakes muffins for her friends using 4 eggs, leaving her with 13 - 4 = 9 eggs. ******\r\n\r\nStep 4: She sells the remaining 9 eggs at the farmers' market for $2 per egg. ******\r\n\r\nStep 5: The total amount she makes is 9 eggs x $2 per egg = $18. ******\r\n\r\nStep 6: The answer is #### 18. ******", "<|start_header_id|>assistant<|end_header_id|>\n\nStep 1: Janet's ducks lay 16 eggs per day. ******\n\nStep 2: She eats 3 eggs for breakfast, so she is left with 16 - 3 = 13 eggs. ******\n\nStep 3: She bakes muffins for her friends using 4 eggs, leaving her with 13 - 4 = 9 eggs. ******\r\n\r\nStep 4: She sells the remaining 9 eggs at the farmers' market for $2 per egg. ******\r\n\r\nStep 5: The total amount she makes is 9 eggs x $2 per egg = $18. ******\r\n\r\nStep 6: The answer is #### 18. ******"]
Answer Probs: [0.929323503745065, 0.8701242119827396, 0.9807898953487139, 0.8891400735150299, 0.9731058534881993, 0.918771267252889, 1.0, 1.0, 1.0, 1.0]
>> Processing time: 9.214761868934147
>> Answer lists: ['18', '18', '18', '18', '18', '18', '18', '18', '18', '18']
>> Original Correct: 18, True
>> Soft SC  Correct: 18, True
>> Golden    Answer: 18
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|██████████| 1/1 [00:00<00:00,  1.43it/s, est. speed input: 1607.85 toks/s, output: 285.83 toks/s]Processed prompts: 100%|██████████| 1/1 [00:00<00:00,  1.43it/s, est. speed input: 1607.85 toks/s, output: 285.83 toks/s]
/data2/jeongseokoh/miniconda3/envs/myenv/lib/python3.9/site-packages/sklearn/metrics/pairwise.py:2361: DataConversionWarning: Data was converted to boolean for metric jaccard
  warnings.warn(msg, DataConversionWarning)
/data2/jeongseokoh/miniconda3/envs/myenv/lib/python3.9/site-packages/sklearn/base.py:1473: ConvergenceWarning: Number of distinct clusters (2) found smaller than n_clusters (5). Possibly due to duplicate points in X.
  return fit_method(estimator, *args, **kwargs)
Generation job: 0.7022844300372526 sec
Added Probs: [(19.17917869554019, 20), (19.17917869554019, 20), (19.17917869554019, 20), (19.17917869554019, 20), (19.17917869554019, 20), (19.122459328921973, 20), (19.122459328921973, 20), (19.122459328921973, 20), (18.8208213081662, 20), (18.8208213081662, 20)]
Cluster Indices: {0: [5, 6, 7], 1: [0, 1, 2, 3, 4, 8, 9], 2: [], 3: [], 4: []}
Selected Indexes: [5, 0, 6, 7, 7]
Processed prompts:   0%|          | 0/5 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts:  20%|██        | 1/5 [00:01<00:05,  1.46s/it, est. speed input: 784.33 toks/s, output: 34.93 toks/s]Processed prompts: 100%|██████████| 5/5 [00:01<00:00,  3.42it/s, est. speed input: 3920.87 toks/s, output: 174.64 toks/s]
/data2/jeongseokoh/miniconda3/envs/myenv/lib/python3.9/site-packages/sklearn/metrics/pairwise.py:2361: DataConversionWarning: Data was converted to boolean for metric jaccard
  warnings.warn(msg, DataConversionWarning)
/data2/jeongseokoh/miniconda3/envs/myenv/lib/python3.9/site-packages/sklearn/base.py:1473: ConvergenceWarning: Number of distinct clusters (4) found smaller than n_clusters (5). Possibly due to duplicate points in X.
  return fit_method(estimator, *args, **kwargs)
Generation job: 1.4726818039780483 sec
Added Probs: [(25.116776281850374, 26), (23.992423279706532, 25), (25.38496372431065, 26), (24.026606336936663, 25), (25.116776281850374, 26), (23.992423279706532, 25), (25.116776281850374, 26), (23.992423279706532, 25), (25.116776281850374, 26), (23.992423279706532, 25)]
Cluster Indices: {0: [1, 5, 7, 9], 1: [0, 4, 6, 8], 2: [2], 3: [3], 4: []}
Selected Indexes: [1, 0, 2, 3, 5]
Processed prompts:   0%|          | 0/5 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts:  20%|██        | 1/5 [00:01<00:05,  1.45s/it, est. speed input: 804.59 toks/s, output: 34.38 toks/s]Processed prompts: 100%|██████████| 5/5 [00:01<00:00,  3.50it/s, est. speed input: 3292.46 toks/s, output: 147.97 toks/s]Processed prompts: 100%|██████████| 5/5 [00:01<00:00,  2.81it/s, est. speed input: 3292.46 toks/s, output: 147.97 toks/s]
/data2/jeongseokoh/miniconda3/envs/myenv/lib/python3.9/site-packages/sklearn/metrics/pairwise.py:2361: DataConversionWarning: Data was converted to boolean for metric jaccard
  warnings.warn(msg, DataConversionWarning)
Generation job: 1.7896343019092456 sec
Added Probs: [(24.731058534881996, 25), (24.731058534881996, 25), (24.58301138409209, 25), (24.58301138409209, 25), (24.141295766256505, 25), (36.26894141088704, 38), (24.679178696492517, 25), (24.679178696492517, 25), (24.731058534881996, 25), (24.731058534881996, 25)]
Cluster Indices: {0: [5], 1: [0, 1, 8, 9], 2: [4], 3: [6, 7], 4: [2, 3]}
Selected Indexes: [5, 0, 4, 6, 2]
Processed prompts:   0%|          | 0/5 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts:  20%|██        | 1/5 [00:01<00:04,  1.12s/it, est. speed input: 1077.10 toks/s, output: 23.16 toks/s]Processed prompts: 100%|██████████| 5/5 [00:01<00:00,  4.45it/s, est. speed input: 5336.13 toks/s, output: 114.90 toks/s]
/data2/jeongseokoh/miniconda3/envs/myenv/lib/python3.9/site-packages/sklearn/metrics/pairwise.py:2361: DataConversionWarning: Data was converted to boolean for metric jaccard
  warnings.warn(msg, DataConversionWarning)
Generation job: 1.1335418060189113 sec
Added Probs: [(13.0, 13), (13.0, 13), (12.705785027818136, 13), (12.705785027818136, 13), (12.731058534881994, 13), (12.731058534881994, 13), (12.651354879372176, 13), (11.34864513281513, 12), (12.731058534881994, 13), (12.731058534881994, 13)]
Cluster Indices: {0: [4, 5], 1: [2, 3], 2: [0, 1], 3: [8, 9], 4: [6, 7]}
Selected Indexes: [4, 2, 0, 8, 6]
Found EoS token, Break
completions: ['<|start_header_id|>assistant<|end_header_id|>\n\nStep 1: The robe takes 2 bolts of blue fiber. ****** Step 2: It takes half that much white fiber, which is 2 / 2 = 1 bolt. ****** Step 3: In total, the robe takes 2 bolts of blue fiber and 1 bolt of white fiber, which is 2 + 1 = 3 bolts. ****** Step 4: The answer is #### 3. ******', '<|start_header_id|>assistant<|end_header_id|>\n\nStep 1: The robe takes 2 bolts of blue fiber. ****** Step 2: It takes half that much white fiber, which is 2 / 2 = 1 bolt. ****** Step 3: In total, the robe takes 2 bolts of blue fiber and 1 bolt of white fiber, which is 2 + 1 = 3 bolts. ****** Step 4: The answer is #### 3. ******', '<|start_header_id|>assistant<|end_header_id|>\n\nStep 1: A robe takes 2 bolts of blue fiber. ****** Step 2: It takes half that much white fiber, which is 2/2 = 1 bolt. ****** Step 3: In total, it takes 2 bolts of blue fiber and 1 bolt of white fiber. ****** Step 4: The answer is #### 3. ******', '<|start_header_id|>assistant<|end_header_id|>\n\nStep 1: A robe takes 2 bolts of blue fiber. ****** Step 2: It takes half that much white fiber, which is 2/2 = 1 bolt. ****** Step 3: In total, it takes 2 bolts of blue fiber and 1 bolt of white fiber. ****** Step 4: The answer is #### 3. ******', '<|start_header_id|>assistant<|end_header_id|>\n\nStep 1: The robe takes 2 bolts of blue fiber. ****** Step 2: It takes half that much white fiber, which is 2 / 2 = 1 bolt. ****** Step 3: In total, it takes 2 bolts of blue fiber and 1 bolt of white fiber. ****** Step 4: The answer is #### 3. ******', '<|start_header_id|>assistant<|end_header_id|>\n\nStep 1: The robe takes 2 bolts of blue fiber. ****** Step 2: It takes half that much white fiber, which is 2 / 2 = 1 bolt. ****** Step 3: In total, it takes 2 bolts of blue fiber and 1 bolt of white fiber. ****** Step 4: The answer is #### 3. ******', '<|start_header_id|>assistant<|end_header_id|>\n\nStep 1: The robe takes 2 bolts of blue fiber. ****** Step 2: It takes half that much white fiber, which is 2/2 = 1 bolt. ****** Step 3: In total, it takes 2 bolts of blue fiber and 1 bolt of white fiber. ****** Step 4: The answer is #### 3. ******', '<|start_header_id|>assistant<|end_header_id|>\n\nStep 1: The robe takes 2 bolts of blue fiber. ****** Step 2: It takes half that much white fiber, which is 2/2 = 1 bolt. ****** Step 3: In total, it takes 2 bolts of blue fiber and 1 bolt of white fiber. ****** Step 4: The answer is #### 3.******', '<|start_header_id|>assistant<|end_header_id|>\n\nStep 1: A robe takes 2 bolts of blue fiber. ****** Step 2: It takes half that much white fiber, which is 2 / 2 = 1 bolt. ****** Step 3: In total, it takes 2 bolts of blue fiber and 1 bolt of white fiber. ****** Step 4: The answer is #### 3. ******', '<|start_header_id|>assistant<|end_header_id|>\n\nStep 1: A robe takes 2 bolts of blue fiber. ****** Step 2: It takes half that much white fiber, which is 2 / 2 = 1 bolt. ****** Step 3: In total, it takes 2 bolts of blue fiber and 1 bolt of white fiber. ****** Step 4: The answer is #### 3. ******']
Answer Probs: [1.0, 1.0, 0.9773680790629335, 0.9773680790629335, 0.9793121949909226, 0.9793121949909226, 0.9731811445670905, 0.9457204277345942, 0.9793121949909226, 0.9793121949909226]
>> Processing time: 5.222695801989175
>> Answer lists: ['3', '3', '3', '3', '3', '3', '3', '3', '3', '3']
>> Original Correct: 3, True
>> Soft SC  Correct: 3, True
>> Golden    Answer: 3
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|██████████| 1/1 [00:01<00:00,  1.44s/it, est. speed input: 798.32 toks/s, output: 171.76 toks/s]Processed prompts: 100%|██████████| 1/1 [00:01<00:00,  1.44s/it, est. speed input: 798.32 toks/s, output: 171.76 toks/s]
/data2/jeongseokoh/miniconda3/envs/myenv/lib/python3.9/site-packages/sklearn/metrics/pairwise.py:2361: DataConversionWarning: Data was converted to boolean for metric jaccard
  warnings.warn(msg, DataConversionWarning)
/data2/jeongseokoh/miniconda3/envs/myenv/lib/python3.9/site-packages/sklearn/base.py:1473: ConvergenceWarning: Number of distinct clusters (4) found smaller than n_clusters (5). Possibly due to duplicate points in X.
  return fit_method(estimator, *args, **kwargs)
Generation job: 1.4411465879529715 sec
Added Probs: [(19.353517864756295, 20), (19.353517864756295, 20), (19.353517864756295, 20), (19.353517864756295, 20), (19.353517864756295, 20), (19.353517864756295, 20), (18.831117907844657, 20), (27.215123330223673, 29), (27.215123330223673, 29), (45.94021508820065, 49)]
Cluster Indices: {0: [0, 1, 2, 3, 4, 5], 1: [9], 2: [7, 8], 3: [6], 4: []}
Selected Indexes: [0, 9, 7, 6, 1]
Processed prompts:   0%|          | 0/5 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts:  20%|██        | 1/5 [00:01<00:06,  1.51s/it, est. speed input: 778.50 toks/s, output: 35.05 toks/s]Processed prompts:  40%|████      | 2/5 [00:01<00:02,  1.30it/s, est. speed input: 1334.08 toks/s, output: 71.11 toks/s]Processed prompts: 100%|██████████| 5/5 [00:02<00:00,  2.73it/s, est. speed input: 2471.51 toks/s, output: 163.56 toks/s]Processed prompts: 100%|██████████| 5/5 [00:02<00:00,  2.10it/s, est. speed input: 2471.51 toks/s, output: 163.56 toks/s]
/data2/jeongseokoh/miniconda3/envs/myenv/lib/python3.9/site-packages/sklearn/metrics/pairwise.py:2361: DataConversionWarning: Data was converted to boolean for metric jaccard
  warnings.warn(msg, DataConversionWarning)
Generation job: 2.389273456064984 sec
Added Probs: [(34.52043999747818, 36), (34.52043999747818, 36), (56.0869313713698, 60), (55.87286010215831, 60), (25.918049150761178, 27), (24.16226367160876, 26), (34.68494511611447, 36), (34.68494511611447, 36), (34.52043999747818, 36), (34.52043999747818, 36)]
Cluster Indices: {0: [4, 5], 1: [6, 7], 2: [2], 3: [0, 1, 8, 9], 4: [3]}
Selected Indexes: [4, 6, 2, 0, 3]
Processed prompts:   0%|          | 0/5 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts:  20%|██        | 1/5 [00:02<00:08,  2.05s/it, est. speed input: 612.06 toks/s, output: 43.86 toks/s]Processed prompts:  60%|██████    | 3/5 [00:02<00:01,  1.72it/s, est. speed input: 1699.93 toks/s, output: 124.43 toks/s]Processed prompts: 100%|██████████| 5/5 [00:02<00:00,  2.26it/s, est. speed input: 2768.11 toks/s, output: 210.64 toks/s]
/data2/jeongseokoh/miniconda3/envs/myenv/lib/python3.9/site-packages/sklearn/metrics/pairwise.py:2361: DataConversionWarning: Data was converted to boolean for metric jaccard
  warnings.warn(msg, DataConversionWarning)
Generation job: 2.226437871111557 sec
Added Probs: [(42.61115510022966, 46), (35.88416107704069, 40), (47.781819561153554, 51), (42.210223711152295, 46), (46.98289748526913, 50), (41.56321191024108, 46), (47.812951107808495, 51), (42.156837682041385, 46), (42.127210982848766, 45), (42.127210982848766, 45)]
Cluster Indices: {0: [5, 8, 9], 1: [3, 7], 2: [0, 1], 3: [2, 6], 4: [4]}
Selected Indexes: [8, 3, 0, 6, 4]
Processed prompts:   0%|          | 0/5 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts:  20%|██        | 1/5 [00:01<00:07,  1.77s/it, est. speed input: 707.82 toks/s, output: 39.48 toks/s]Processed prompts:  40%|████      | 2/5 [00:01<00:02,  1.17it/s, est. speed input: 1259.39 toks/s, output: 74.41 toks/s]Processed prompts:  60%|██████    | 3/5 [00:02<00:01,  1.86it/s, est. speed input: 1747.71 toks/s, output: 110.77 toks/s]Processed prompts:  80%|████████  | 4/5 [00:02<00:00,  2.58it/s, est. speed input: 2195.89 toks/s, output: 136.70 toks/s]Processed prompts: 100%|██████████| 5/5 [00:03<00:00,  1.67it/s, est. speed input: 1943.09 toks/s, output: 129.84 toks/s]Processed prompts: 100%|██████████| 5/5 [00:03<00:00,  1.53it/s, est. speed input: 1943.09 toks/s, output: 129.84 toks/s]
/data2/jeongseokoh/miniconda3/envs/myenv/lib/python3.9/site-packages/sklearn/metrics/pairwise.py:2361: DataConversionWarning: Data was converted to boolean for metric jaccard
  warnings.warn(msg, DataConversionWarning)
Generation job: 3.2847050570417196 sec
Added Probs: [(14.773814208294146, 16), (82.90939865999803, 94), (33.401804200318225, 35), (40.44060717519072, 43), (46.23453901599579, 49), (38.183117230208296, 41), (33.60386480452032, 35), (33.60386480452032, 35), (20.57575862246594, 22), (48.9738309462229, 55)]
Cluster Indices: {0: [4, 5], 1: [8, 9], 2: [6, 7], 3: [0, 1], 4: [2, 3]}
Selected Indexes: [4, 8, 6, 0, 2]
Processed prompts:   0%|          | 0/5 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts:  20%|██        | 1/5 [00:00<00:03,  1.20it/s, est. speed input: 1592.37 toks/s, output: 2.40 toks/s]Processed prompts:  60%|██████    | 3/5 [00:01<00:00,  2.88it/s, est. speed input: 3315.16 toks/s, output: 26.98 toks/s]Processed prompts:  80%|████████  | 4/5 [00:01<00:00,  2.91it/s, est. speed input: 3428.71 toks/s, output: 49.81 toks/s]Processed prompts: 100%|██████████| 5/5 [00:01<00:00,  3.28it/s, est. speed input: 4270.51 toks/s, output: 78.65 toks/s]
/data2/jeongseokoh/miniconda3/envs/myenv/lib/python3.9/site-packages/sklearn/metrics/pairwise.py:2361: DataConversionWarning: Data was converted to boolean for metric jaccard
  warnings.warn(msg, DataConversionWarning)
Generation job: 1.5381827789824456 sec
Added Probs: [(15.571504774226383, 17), (22.92001472510598, 27), (1.0, 1), (1.0, 1), (14.0, 14), (14.0, 14), (1.0, 1), (1.0, 1), (15.532489522540072, 17), (20.62701292726045, 27)]
Cluster Indices: {0: [4, 5], 1: [2, 3], 2: [8, 9], 3: [6, 7], 4: [0, 1]}
Selected Indexes: [4, 2, 8, 6, 0]
Processed prompts:   0%|          | 0/5 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts:  20%|██        | 1/5 [00:00<00:03,  1.18it/s, est. speed input: 1539.89 toks/s, output: 2.36 toks/s]Processed prompts:  80%|████████  | 4/5 [00:01<00:00,  3.22it/s, est. speed input: 3742.33 toks/s, output: 30.66 toks/s]Processed prompts: 100%|██████████| 5/5 [00:01<00:00,  2.87it/s, est. speed input: 3548.55 toks/s, output: 51.90 toks/s]Processed prompts: 100%|██████████| 5/5 [00:01<00:00,  2.70it/s, est. speed input: 3548.55 toks/s, output: 51.90 toks/s]
/data2/jeongseokoh/miniconda3/envs/myenv/lib/python3.9/site-packages/sklearn/metrics/pairwise.py:2361: DataConversionWarning: Data was converted to boolean for metric jaccard
  warnings.warn(msg, DataConversionWarning)
Generation job: 1.8633332970784977 sec
Added Probs: [(1.0, 1), (1.0, 1), (1.0, 1), (1.0, 1), (14.599061312018623, 15), (18.428863673504488, 22), (1.0, 1), (1.0, 1), (37.38452835261667, 40), (10.130879391468095, 13)]
Cluster Indices: {0: [4, 5], 1: [6, 7], 2: [0, 1], 3: [2, 3], 4: [8, 9]}
Selected Indexes: [4, 6, 0, 2, 8]
Processed prompts:   0%|          | 0/5 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts:  20%|██        | 1/5 [00:00<00:03,  1.18it/s, est. speed input: 1554.77 toks/s, output: 2.36 toks/s]Processed prompts: 100%|██████████| 5/5 [00:01<00:00,  4.68it/s, est. speed input: 5259.07 toks/s, output: 30.99 toks/s]Processed prompts: 100%|██████████| 5/5 [00:01<00:00,  3.97it/s, est. speed input: 5259.07 toks/s, output: 30.99 toks/s]
/data2/jeongseokoh/miniconda3/envs/myenv/lib/python3.9/site-packages/sklearn/metrics/pairwise.py:2361: DataConversionWarning: Data was converted to boolean for metric jaccard
  warnings.warn(msg, DataConversionWarning)
Generation job: 1.2704934879438952 sec
Added Probs: [(1.0, 1), (1.0, 1), (1.0, 1), (1.0, 1), (1.0, 1), (1.0, 1), (1.0, 1), (1.0, 1), (13.039098142764372, 14), (14.532192671928339, 17)]
Cluster Indices: {0: [4, 5], 1: [6, 7], 2: [8, 9], 3: [0, 1], 4: [2, 3]}
Selected Indexes: [4, 6, 8, 0, 2]
Processed prompts:   0%|          | 0/5 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts:  20%|██        | 1/5 [00:00<00:03,  1.18it/s, est. speed input: 1538.16 toks/s, output: 2.36 toks/s]Processed prompts: 100%|██████████| 5/5 [00:00<00:00,  5.90it/s, est. speed input: 7821.67 toks/s, output: 11.79 toks/s]
/data2/jeongseokoh/miniconda3/envs/myenv/lib/python3.9/site-packages/sklearn/metrics/pairwise.py:2361: DataConversionWarning: Data was converted to boolean for metric jaccard
  warnings.warn(msg, DataConversionWarning)
Generation job: 0.859711553901434 sec
Added Probs: [(1.0, 1), (1.0, 1), (1.0, 1), (1.0, 1), (1.0, 1), (1.0, 1), (1.0, 1), (1.0, 1), (1.0, 1), (1.0, 1)]
Cluster Indices: {0: [4, 5], 1: [6, 7], 2: [2, 3], 3: [0, 1], 4: [8, 9]}
Selected Indexes: [4, 6, 2, 0, 8]
Found EoS token, Break
completions: ['<|start_header_id|>assistant<|end_header_id|>\n\nStep 1: Josh buys a house for $80,000. ****** Step 2: He puts in $50,000 in repairs, so the total cost is $80,000 + $50,000 = $130,000. ****** Step 3: The value of the house increased by 150%, so the new value is $80,000 + (150% of $80,000) = $80,000 + $120,000 = $200,000. ****** Step 4: Josh sells the house for $200,000, so his profit is $200,000 - $130,000 = $70,000. ****** Step 5: The answer is #### 70000. ******', '<|start_header_id|>assistant<|end_header_id|>\n\nStep 1: Josh buys a house for $80,000. ****** Step 2: He puts in $50,000 in repairs, so the total cost is $80,000 + $50,000 = $130,000. ****** Step 3: The value of the house increased by 150%, so the new value is $80,000 + (150% of $80,000) = $80,000 + $120,000 = $200,000. ****** Step 4: Josh sells the house for $200,000, so his profit is $200,000 - $130,000 = $70,000. ****** Step 5: The answer is #### 70000. ******', "<|start_header_id|>assistant<|end_header_id|>\n\nStep 1: Josh buys the house for $80,000 and puts in $50,000 in repairs, so the total cost is $80,000 + $50,000 = $130,000. ******\n\nStep 2: The value of the house increases by 150%, so the new value is 1.5 times the original value. The original value is $80,000, so the new value is 1.5 * $80,000 = $120,000. ******\n\nStep 3: The profit is the difference between the new value and the total cost. The profit is $120,000 - $130,000 = -$10,000. However, this is a loss, not a profit. *******\n\nStep 4: Since Josh didn't make a profit, the answer is #### 0. ******", "<|start_header_id|>assistant<|end_header_id|>\n\nStep 1: Josh buys the house for $80,000 and puts in $50,000 in repairs, so the total cost is $80,000 + $50,000 = $130,000. ******\n\nStep 2: The value of the house increases by 150%, so the new value is 1.5 times the original value. The original value is $80,000, so the new value is 1.5 * $80,000 = $120,000. ******\n\nStep 3: The profit is the difference between the new value and the total cost. The profit is $120,000 - $130,000 = -$10,000. However, this is a loss, not a profit. *******\n\nStep 4: Since Josh didn't make a profit, the answer is #### 0. ******", '<|start_header_id|>assistant<|end_header_id|>\n\nStep 1: Josh buys the house for $80,000 and puts in $50,000 in repairs. ****** Step 2: The total amount he spent is $80,000 + $50,000 = $130,000. ****** Step 3: The value of the house increased by 150%, so the new value is 150% of the original value, which is 150/100 * $80,000 = $120,000. ****** Step 4: Since the new value is $120,000, his profit is the difference between the new value and the total amount he spent, which is $120,000 - $130,000 = -$10,000. ****** Step 5: However, this is a loss, not a profit. ****** Step 6: To find the profit, we need to subtract the original value from the new value, which is $120,000 - $80,000 = $40,000. ****** Step 7: The answer is #### 40000. ******', '<|start_header_id|>assistant<|end_header_id|>\n\nStep 1: Josh buys the house for $80,000 and puts in $50,000 in repairs. ****** Step 2: The total amount he spent is $80,000 + $50,000 = $130,000. ****** Step 3: The value of the house increased by 150%, so the new value is 150% of the original value, which is 150/100 * $80,000 = $120,000. ****** Step 4: Since the new value is $120,000, his profit is the difference between the new value and the total amount he spent, which is $120,000 - $130,000 = -$10,000. ****** Step 5: However, this is a loss, not a profit. ****** Step 6: To find the profit, we need to subtract the original value from the new value, which is $120,000 - $80,000 = $40,000. ****** Step 7: The answer is #### 40000. ******', '<|start_header_id|>assistant<|end_header_id|>\n\nStep 1: Josh buys the house for $80,000. ****** Step 2: He puts in $50,000 in repairs, so the total cost is $80,000 + $50,000 = $130,000. ****** Step 3: The value of the house increased by 150%, so the new value is 130% of the original value, which is 1.5 x $80,000 = $120,000. ****** Step 4: Since he sold the house for $120,000, his profit is $120,000 - $130,000 = -$10,000. ****** Step 5: However, this is a loss, not a profit. ****** Step 6: The answer is #### -10,000. ******', '<|start_header_id|>assistant<|end_header_id|>\n\nStep 1: Josh buys the house for $80,000. ****** Step 2: He puts in $50,000 in repairs, so the total cost is $80,000 + $50,000 = $130,000. ****** Step 3: The value of the house increased by 150%, so the new value is 130% of the original value, which is 1.5 x $80,000 = $120,000. ****** Step 4: Since he sold the house for $120,000, his profit is $120,000 - $130,000 = -$10,000. ****** Step 5: However, this is a loss, not a profit. ****** Step 6: The answer is #### -10,000. ******', '<|start_header_id|>assistant<|end_header_id|>\n\nStep 1: Josh buys the house for $80,000 and puts in $50,000 in repairs, so the total cost is $80,000 + $50,000 = $130,000. ******\n\nStep 2: The value of the house increased by 150%, so the new value is 1.5 times the original value. The original value was $80,000, so the new value is 1.5 * $80,000 = $120,000. ******\n\nStep 3: Since Josh spent $130,000 and the house is now worth $120,000, he made a loss of $130,000 - $120,000 = $10,000. ******\n\nStep 4: The answer is #### -10,000. ******', '<|start_header_id|>assistant<|end_header_id|>\n\nStep 1: Josh buys the house for $80,000 and puts in $50,000 in repairs, so the total cost is $80,000 + $50,000 = $130,000. ******\n\nStep 2: The value of the house increased by 150%, so the new value is 1.5 times the original value. The original value was $80,000, so the new value is 1.5 * $80,000 = $120,000. ******\n\nStep 3: Since Josh spent $130,000 and the house is now worth $120,000, he made a loss of $130,000 - $120,000 = $10,000. ******\n\nStep 4: The answer is #### -10,000. ******']
Answer Probs: {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0}
>> Processing time: 15.108887112000957
[rank0]: Traceback (most recent call last):
[rank0]:   File "/data2/jeongseokoh/jeongseokoh/inter_SC/inter_SC_llm.py", line 904, in <module>
[rank0]:     main()
[rank0]:   File "/data2/jeongseokoh/jeongseokoh/inter_SC/inter_SC_llm.py", line 889, in main
[rank0]:     results = parallel_process(context=c_dataset, question=q_dataset, answer=a_dataset, option=o_dataset, cot_ex=cot_ex, model=model, model_name=selected_model, dataset=selected_dataset)
[rank0]:   File "/data2/jeongseokoh/jeongseokoh/inter_SC/inter_SC_llm.py", line 512, in parallel_process
[rank0]:     softsc_answer, softsc_conf = prob_process(original_answer_completion, ansProb)
[rank0]:   File "/data2/jeongseokoh/jeongseokoh/inter_SC/inter_SC_llm.py", line 474, in prob_process
[rank0]:     max_index = probs.index(max(probs))
[rank0]: AttributeError: 'dict' object has no attribute 'index'
srun: error: n02: task 0: Exited with exit code 1
