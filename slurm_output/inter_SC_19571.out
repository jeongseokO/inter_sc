The token has not been saved to the git credentials helper. Pass `add_to_git_credential=True` in this function directly or `--add-to-git-credential` if using via `huggingface-cli` if you want to set the git credential as well.
Token is valid (permission: fineGrained).
Your token has been saved to /home/jeongseokoh/.cache/huggingface/token
Login successful
Inter SC_beam
Num Path: 20 + 5 x 4, Interval: 100
INFO 08-09 09:16:19 llm_engine.py:161] Initializing an LLM engine (v0.5.0.post1) with config: model='meta-llama/Meta-Llama-3-8B-Instruct', speculative_config=None, tokenizer='meta-llama/Meta-Llama-3-8B-Instruct', skip_tokenizer_init=False, tokenizer_mode=auto, revision=None, rope_scaling=None, rope_theta=None, tokenizer_revision=None, trust_remote_code=False, dtype=torch.bfloat16, max_seq_len=8192, download_dir='../../hub/model/', load_format=LoadFormat.AUTO, tensor_parallel_size=1, disable_custom_all_reduce=False, quantization=None, enforce_eager=False, kv_cache_dtype=auto, quantization_param_path=None, device_config=cuda, decoding_config=DecodingConfig(guided_decoding_backend='outlines'), seed=0, served_model_name=meta-llama/Meta-Llama-3-8B-Instruct)
INFO 08-09 09:16:31 weight_utils.py:218] Using model weights format ['*.safetensors']
INFO 08-09 09:16:35 model_runner.py:160] Loading model weights took 14.9595 GB
INFO 08-09 09:16:36 gpu_executor.py:83] # GPU blocks: 13407, # CPU blocks: 2048
INFO 08-09 09:16:39 model_runner.py:889] Capturing the model for CUDA graphs. This may lead to unexpected consequences if the model is not static. To run the model in eager mode, set 'enforce_eager=True' or use '--enforce-eager' in the CLI.
INFO 08-09 09:16:39 model_runner.py:893] CUDA graphs can take additional 1~3 GiB memory per GPU. If you are running out of memory, consider decreasing `gpu_memory_utilization` or enforcing eager mode. You can also reduce the `max_num_seqs` as needed to decrease memory usage.
INFO 08-09 09:16:48 model_runner.py:965] Graph capturing finished in 8 secs.
Model: llama3_8b is selected
Dataset: gsm8k is selected
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|██████████| 1/1 [00:03<00:00,  3.15s/it, est. speed input: 295.29 toks/s, output: 635.71 toks/s]Processed prompts: 100%|██████████| 1/1 [00:03<00:00,  3.15s/it, est. speed input: 295.29 toks/s, output: 635.71 toks/s]
Generation job: 3.1538427269551903 sec
Processed prompts:   0%|          | 0/5 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts:  20%|██        | 1/5 [00:00<00:03,  1.11it/s, est. speed input: 1145.58 toks/s, output: 35.62 toks/s]Processed prompts:  40%|████      | 2/5 [00:01<00:02,  1.40it/s, est. speed input: 1386.57 toks/s, output: 97.02 toks/s]Processed prompts: 100%|██████████| 5/5 [00:01<00:00,  3.16it/s, est. speed input: 2625.89 toks/s, output: 252.63 toks/s]Processed prompts: 100%|██████████| 5/5 [00:01<00:00,  2.55it/s, est. speed input: 2625.89 toks/s, output: 252.63 toks/s]
Generation job: 1.9686667749192566 sec
Found EoS token, Break
>> Processing time: 5.149793277028948
>> Answer lists: ['18', '18', '18', '18', '18', '18', '18', '18', '18', '18', '18', '18', '18', '18', '18', '18', '18', '18', '18', '18']
>> Original Correct: 18, True
>> Golden    Answer: 18
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|██████████| 1/1 [00:03<00:00,  3.00s/it, est. speed input: 297.00 toks/s, output: 531.73 toks/s]Processed prompts: 100%|██████████| 1/1 [00:03<00:00,  3.00s/it, est. speed input: 297.00 toks/s, output: 531.73 toks/s]
Generation job: 3.0061615940649062 sec
Processed prompts:   0%|          | 0/5 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts:  20%|██        | 1/5 [00:00<00:02,  1.56it/s, est. speed input: 1516.05 toks/s, output: 6.25 toks/s]Processed prompts: 100%|██████████| 5/5 [00:00<00:00,  7.80it/s, est. speed input: 7554.70 toks/s, output: 31.22 toks/s]
Generation job: 0.6488895379006863 sec
Found EoS token, Break
>> Processing time: 3.655786872841418
>> Answer lists: ['3', '3', '3', '3', '3', '3', '3', '3', '3', '3', '3', '3', '3', '3', '3', '3', '3', '3', '3', '3']
>> Original Correct: 3, True
>> Golden    Answer: 3
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|██████████| 1/1 [00:03<00:00,  3.11s/it, est. speed input: 293.90 toks/s, output: 642.40 toks/s]Processed prompts: 100%|██████████| 1/1 [00:03<00:00,  3.11s/it, est. speed input: 293.90 toks/s, output: 642.40 toks/s]
Generation job: 3.1151589930523187 sec
Processed prompts:   0%|          | 0/5 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts:  20%|██        | 1/5 [00:03<00:14,  3.58s/it, est. speed input: 283.26 toks/s, output: 68.09 toks/s]Processed prompts: 100%|██████████| 5/5 [00:03<00:00,  1.40it/s, est. speed input: 1416.17 toks/s, output: 448.99 toks/s]
Generation job: 3.5916341128759086 sec
Processed prompts:   0%|          | 0/5 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts:  20%|██        | 1/5 [00:00<00:02,  1.40it/s, est. speed input: 1491.80 toks/s, output: 5.61 toks/s]Processed prompts: 100%|██████████| 5/5 [00:00<00:00,  7.01it/s, est. speed input: 7543.32 toks/s, output: 28.06 toks/s]
Generation job: 0.7214664311613888 sec
Found EoS token, Break
>> Processing time: 7.429235739866272
>> Answer lists: ['30000', '30000', '30000', '30000', '30000', '30000', '30000', '30000', '40000', '40000', '40000', '40000', '30000', '30000', '30000', '30000', '10000', '10000', '10000', '10000']
>> Original Correct: 30000, False
>> Golden    Answer: 70000
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|██████████| 1/1 [00:02<00:00,  2.72s/it, est. speed input: 330.52 toks/s, output: 529.56 toks/s]Processed prompts: 100%|██████████| 1/1 [00:02<00:00,  2.72s/it, est. speed input: 330.52 toks/s, output: 529.56 toks/s]
Generation job: 2.725113255903125 sec
Processed prompts:   0%|          | 0/5 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts:  20%|██        | 1/5 [00:00<00:02,  1.59it/s, est. speed input: 1539.43 toks/s, output: 6.37 toks/s]Processed prompts: 100%|██████████| 5/5 [00:00<00:00,  7.96it/s, est. speed input: 7700.69 toks/s, output: 31.86 toks/s]
Generation job: 0.6355634399224073 sec
Found EoS token, Break
>> Processing time: 3.361304268008098
>> Answer lists: ['540', '540', '540', '540', '540', '540', '540', '540', '540', '540', '540', '540', '540', '540', '540', '540', '540', '540', '540', '540']
>> Original Correct: 540, True
>> Golden    Answer: 540
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|██████████| 1/1 [00:03<00:00,  3.27s/it, est. speed input: 297.72 toks/s, output: 611.33 toks/s]Processed prompts: 100%|██████████| 1/1 [00:03<00:00,  3.27s/it, est. speed input: 297.72 toks/s, output: 611.33 toks/s]
Generation job: 3.273796323919669 sec
Processed prompts:   0%|          | 0/5 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts:  20%|██        | 1/5 [00:01<00:05,  1.30s/it, est. speed input: 828.76 toks/s, output: 64.82 toks/s]Processed prompts:  40%|████      | 2/5 [00:02<00:03,  1.10s/it, est. speed input: 949.29 toks/s, output: 128.16 toks/s]Processed prompts:  60%|██████    | 3/5 [00:02<00:01,  1.24it/s, est. speed input: 1187.45 toks/s, output: 200.85 toks/s]Processed prompts:  80%|████████  | 4/5 [00:03<00:00,  1.25it/s, est. speed input: 1222.90 toks/s, output: 259.32 toks/s]Processed prompts: 100%|██████████| 5/5 [00:03<00:00,  1.42it/s, est. speed input: 1528.56 toks/s, output: 372.89 toks/s]
Generation job: 3.5217032679356635 sec
Processed prompts:   0%|          | 0/5 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts:  20%|██        | 1/5 [00:00<00:02,  1.39it/s, est. speed input: 1524.24 toks/s, output: 5.57 toks/s]Processed prompts: 100%|██████████| 5/5 [00:00<00:00,  6.96it/s, est. speed input: 7660.83 toks/s, output: 27.86 toks/s]
Generation job: 0.7267407430335879 sec
Found EoS token, Break
>> Processing time: 7.523372997995466
>> Answer lists: ['20', '20', '20', '20', '20', '20', '20', '20', '20', '20', '20', '20', '20', '20', '20', '20', '20', '20', '20', '20']
>> Original Correct: 20, True
>> Golden    Answer: 20
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|██████████| 1/1 [00:03<00:00,  3.11s/it, est. speed input: 295.52 toks/s, output: 642.43 toks/s]Processed prompts: 100%|██████████| 1/1 [00:03<00:00,  3.11s/it, est. speed input: 295.52 toks/s, output: 642.43 toks/s]
Generation job: 3.1150515228509903 sec
Processed prompts:   0%|          | 0/5 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts:  20%|██        | 1/5 [00:02<00:09,  2.26s/it, est. speed input: 451.71 toks/s, output: 93.88 toks/s]Processed prompts:  60%|██████    | 3/5 [00:02<00:01,  1.21it/s, est. speed input: 1050.10 toks/s, output: 232.67 toks/s]Processed prompts:  80%|████████  | 4/5 [00:03<00:00,  1.73it/s, est. speed input: 1352.35 toks/s, output: 314.55 toks/s]Processed prompts: 100%|██████████| 5/5 [00:03<00:00,  2.30it/s, est. speed input: 1611.37 toks/s, output: 395.89 toks/s]Processed prompts: 100%|██████████| 5/5 [00:03<00:00,  1.58it/s, est. speed input: 1611.37 toks/s, output: 395.89 toks/s]
Generation job: 3.172904568957165 sec
Found EoS token, Break
>> Processing time: 6.288972582202405
>> Answer lists: ['64', '64', '64', '64', '64', '64', '64', '64', '64', '64', '64', '64', '64', '64', '64', '64', '64', '64', '64', '64']
>> Original Correct: 64, True
>> Golden    Answer: 64
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|██████████| 1/1 [00:03<00:00,  3.11s/it, est. speed input: 291.46 toks/s, output: 642.69 toks/s]Processed prompts: 100%|██████████| 1/1 [00:03<00:00,  3.11s/it, est. speed input: 291.46 toks/s, output: 642.69 toks/s]
Generation job: 3.114397937897593 sec
Processed prompts:   0%|          | 0/5 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts:  20%|██        | 1/5 [00:01<00:04,  1.03s/it, est. speed input: 975.92 toks/s, output: 50.39 toks/s]Processed prompts: 100%|██████████| 5/5 [00:01<00:00,  5.36it/s, est. speed input: 4243.17 toks/s, output: 220.79 toks/s]Processed prompts: 100%|██████████| 5/5 [00:01<00:00,  4.21it/s, est. speed input: 4243.17 toks/s, output: 220.79 toks/s]
Generation job: 1.1942045069299638 sec
Found EoS token, Break
>> Processing time: 4.309469057014212
>> Answer lists: ['260', '260', '260', '260', '260', '260', '260', '260', '260', '260', '260', '260', '260', '260', '260', '260', '260', '260', '260', '260']
>> Original Correct: 260, True
>> Golden    Answer: 260
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|██████████| 1/1 [00:03<00:00,  3.12s/it, est. speed input: 298.62 toks/s, output: 641.49 toks/s]Processed prompts: 100%|██████████| 1/1 [00:03<00:00,  3.12s/it, est. speed input: 298.62 toks/s, output: 641.49 toks/s]
Generation job: 3.1200284108053893 sec
Processed prompts:   0%|          | 0/5 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts:  20%|██        | 1/5 [00:03<00:14,  3.67s/it, est. speed input: 280.62 toks/s, output: 105.33 toks/s]Processed prompts: 100%|██████████| 5/5 [00:03<00:00,  1.36it/s, est. speed input: 1403.02 toks/s, output: 540.25 toks/s]
Generation job: 3.6824531729798764 sec
Processed prompts:   0%|          | 0/5 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts:  20%|██        | 1/5 [00:00<00:03,  1.31it/s, est. speed input: 1486.06 toks/s, output: 5.26 toks/s]Processed prompts:  40%|████      | 2/5 [00:00<00:01,  2.22it/s, est. speed input: 2272.73 toks/s, output: 28.13 toks/s]Processed prompts:  60%|██████    | 3/5 [00:01<00:00,  2.99it/s, est. speed input: 2847.16 toks/s, output: 67.13 toks/s]Processed prompts:  80%|████████  | 4/5 [00:02<00:00,  1.34it/s, est. speed input: 1761.08 toks/s, output: 79.80 toks/s]Processed prompts: 100%|██████████| 5/5 [00:03<00:00,  1.28it/s, est. speed input: 1660.09 toks/s, output: 177.60 toks/s]Processed prompts: 100%|██████████| 5/5 [00:03<00:00,  1.47it/s, est. speed input: 1660.09 toks/s, output: 177.60 toks/s]
Generation job: 3.414836779003963 sec
Processed prompts:   0%|          | 0/5 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts:  20%|██        | 1/5 [00:00<00:03,  1.31it/s, est. speed input: 1484.68 toks/s, output: 5.25 toks/s]Processed prompts: 100%|██████████| 5/5 [00:00<00:00,  6.56it/s, est. speed input: 7444.91 toks/s, output: 26.25 toks/s]
Generation job: 0.7708663779776543 sec
Found EoS token, Break
>> Processing time: 10.989596810890362
>> Answer lists: ['120', '120', '120', '120', '120', '120', '120', '120', '120', '120', '120', '120', '120', '120', '120', '120', '120', '120', '120', '120']
>> Original Correct: 120, False
>> Golden    Answer: 160
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|██████████| 1/1 [00:03<00:00,  3.13s/it, est. speed input: 309.12 toks/s, output: 639.34 toks/s]Processed prompts: 100%|██████████| 1/1 [00:03<00:00,  3.13s/it, est. speed input: 309.12 toks/s, output: 639.34 toks/s]
Generation job: 3.130247097928077 sec
Processed prompts:   0%|          | 0/5 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts:  20%|██        | 1/5 [00:03<00:14,  3.69s/it, est. speed input: 288.89 toks/s, output: 108.30 toks/s]Processed prompts: 100%|██████████| 5/5 [00:03<00:00,  1.35it/s, est. speed input: 1444.35 toks/s, output: 541.46 toks/s]
Generation job: 3.7018932159990072 sec
Processed prompts:   0%|          | 0/5 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts:  20%|██        | 1/5 [00:02<00:11,  2.87s/it, est. speed input: 407.14 toks/s, output: 77.45 toks/s]Processed prompts:  40%|████      | 2/5 [00:03<00:03,  1.26s/it, est. speed input: 777.09 toks/s, output: 154.15 toks/s]Processed prompts:  60%|██████    | 3/5 [00:03<00:01,  1.32it/s, est. speed input: 1106.49 toks/s, output: 226.92 toks/s]Processed prompts:  80%|████████  | 4/5 [00:03<00:00,  1.53it/s, est. speed input: 1275.05 toks/s, output: 293.36 toks/s]Processed prompts: 100%|██████████| 5/5 [00:03<00:00,  1.37it/s, est. speed input: 1593.74 toks/s, output: 381.30 toks/s]
Generation job: 3.6697460080031306 sec
Found EoS token, Break
>> Processing time: 10.503384872805327
>> Answer lists: ['315', '315', '315', '315', '315', '315', '315', '315', '315', '315', '315', '315', '315', '315', '135', '285', '315', '315', '315', '8']
>> Original Correct: 315, False
>> Golden    Answer: 45
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|██████████| 1/1 [00:03<00:00,  3.11s/it, est. speed input: 296.52 toks/s, output: 634.80 toks/s]Processed prompts: 100%|██████████| 1/1 [00:03<00:00,  3.11s/it, est. speed input: 296.52 toks/s, output: 634.80 toks/s]
Generation job: 3.115106865996495 sec
Processed prompts:   0%|          | 0/5 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts:  20%|██        | 1/5 [00:01<00:04,  1.04s/it, est. speed input: 984.58 toks/s, output: 50.05 toks/s]Processed prompts:  40%|████      | 2/5 [00:01<00:02,  1.37it/s, est. speed input: 1319.57 toks/s, output: 99.97 toks/s]Processed prompts:  80%|████████  | 4/5 [00:01<00:00,  3.29it/s, est. speed input: 2474.86 toks/s, output: 216.52 toks/s]Processed prompts: 100%|██████████| 5/5 [00:01<00:00,  2.98it/s, est. speed input: 3047.73 toks/s, output: 290.17 toks/s]
Generation job: 1.686293327016756 sec
Found EoS token, Break
>> Processing time: 4.802293493878096
>> Answer lists: ['460', '460', '460', '460', '460', '460', '460', '460', '460', '460', '460', '460', '460', '460', '460', '460', '460', '460', '460', '460']
>> Original Correct: 460, True
>> Golden    Answer: 460
Processed prompts:   0%|          | 0/1 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts: 100%|██████████| 1/1 [00:03<00:00,  3.12s/it, est. speed input: 296.47 toks/s, output: 641.72 toks/s]Processed prompts: 100%|██████████| 1/1 [00:03<00:00,  3.12s/it, est. speed input: 296.47 toks/s, output: 641.72 toks/s]
Generation job: 3.118735817959532 sec
srun: Job step aborted: Waiting up to 32 seconds for job step to finish.
srun: got SIGCONT
slurmstepd-n01: error: *** JOB 19571 ON n01 CANCELLED AT 2024-08-09T09:18:04 ***
Processed prompts:   0%|          | 0/5 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts:  20%|██        | 1/5 [00:00<00:03,  1.26it/s, est. speed input: 1287.35 toks/s, output: 25.14 toks/s]Processed prompts:  40%|████      | 2/5 [00:02<00:03,  1.22s/it, est. speed input: 884.84 toks/s, output: 102.83 toks/s]slurmstepd-n01: error: *** STEP 19571.0 ON n01 CANCELLED AT 2024-08-09T09:18:04 ***
srun: forcing job termination
